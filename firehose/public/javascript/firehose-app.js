!function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t){"use strict";var n=e("../dispatcher/FirehoseDispatcher"),i=e("./FirehoseConstants"),r=e("events").EventEmitter,s=e("object-assign");e("array.prototype.find");var o=s({},r.prototype,{toggleFeature:function(){n.dispatch({actionType:i.TOGGLE_FEATURE})},trash:function(){n.dispatch({actionType:i.TRASH})},navigate:function(e){n.dispatch({actionType:i.NAVIGATE,delta:e})},addListener:function(e,t){this.on(e,t)},deleteListener:function(e,t){this.removeListener(e,t)},emitEvent:function(e,t){this.emit(e,t)}});n.register(function(e){switch(e.actionType){case i.TOGGLE_FEATURE:o.emitEvent(i.TOGGLE_FEATURE);break;case i.TRASH:o.emitEvent(i.TRASH);break;case i.NAVIGATE:o.emitEvent(i.NAVIGATE,e.delta)}}),t.exports=o},{"../dispatcher/FirehoseDispatcher":16,"./FirehoseConstants":2,"array.prototype.find":19,events:20,"object-assign":33}],2:[function(e,t){"use strict";var n={TOGGLE_FEATURE:"TOGGLE_FEATURE",TRASH:"TRASH",NAVIGATE:"NAVIGATE"};t.exports=n},{}],3:[function(e,t){"use strict";var n=window.React,i=e("./header/Header.jsx"),r=e("./views/FirehoseEditor.jsx"),s=e("../actions/FirehoseActions"),o=n.createClass({displayName:"Firehose",getInitialState:function(){return{loggedIn:!1,isAdmin:!1,viewState:"one-up"}},componentDidMount:function(){window.addEventListener("keyup",this.onKeyUpTriggered),window.addEventListener("keydown",this.onKeyDownTriggered),this.setState({csrfToken:document.querySelector("meta[name='csrf-token']").getAttribute("content")})},componentWillUnmount:function(){window.removeEventListener("keyup",this.onKeyUpTriggered),window.removeEventListener("keydown",this.onKeyDownTriggered)},onLoggedIn:function(e){this.setState({loggedIn:!0,isAdmin:!!e.isAdmin})},onLoggedOut:function(){this.setState({loggedIn:!1,isAdmin:!1})},onToggle:function(e){this.setState({viewState:e})},onKeyDownTriggered:function(e){32===e.keyCode&&e.target===document.body&&e.preventDefault()},onKeyUpTriggered:function(e){var t=e.keyCode;if(70===t||32===t)s.toggleFeature();else if(68===t||8===t)s.trash();else if(39===t||37===t){var n=39===t?1:-1;s.navigate(n)}},render:function(){var e=n.createElement(i,{onLoggedIn:this.onLoggedIn,onLoggedOut:this.onLoggedOut,onToggle:this.onToggle,viewState:this.state.viewState,csrfToken:this.state.csrfToken});return this.state.loggedIn&&this.state.isAdmin?n.createElement("div",null,e,n.createElement(r,{viewState:this.state.viewState,csrfToken:this.state.csrfToken})):this.state.loggedIn&&!this.state.isAdmin?n.createElement("div",null,e,n.createElement("div",{className:"container"},n.createElement("h2",null,"You do not have permission to use the Firehose.",n.createElement("br",null),n.createElement("br",null),"Contact ",n.createElement("a",{href:"mailto:cade@mozillafoundation.org"},"@cade")," or ",n.createElement("a",{href:"mailto:jbuck@mozillafoundation.org"},"@jbuck")," for assistance."))):n.createElement("div",null,e,n.createElement("div",{className:"container"},n.createElement("h2",null,"Please sign in")))}});t.exports=o},{"../actions/FirehoseActions":1,"./header/Header.jsx":5,"./views/FirehoseEditor.jsx":11}],4:[function(e){"use strict";var t=window.React,n=e("./Firehose.jsx");t.render(t.createElement(n,null),document.getElementById("firehose-app"))},{"./Firehose.jsx":3}],5:[function(e,t){"use strict";var n=window.React,i=e("./WebmakerLoginUX.jsx"),r=e("./ViewToggle.jsx"),s=n.createClass({displayName:"Header",getInitialState:function(){return{loggedIn:!1,isAdmin:!1}},handleLoggedIn:function(e){this.setState({loggedIn:!0,isAdmin:e.isAdmin}),this.props.onLoggedIn(e)},handleLoggedOut:function(){this.setState({loggedIn:!1,isAdmin:!1}),this.props.onLoggedOut()},onToggle:function(e){this.props.onToggle(e)},render:function(){var e;return e=this.state.loggedIn&&this.state.isAdmin?n.createElement(r,{onToggle:this.onToggle,viewState:this.props.viewState}):"",n.createElement("div",{className:"navbar navbar-inverse navbar-fixed-top"},n.createElement("div",{className:"container"},n.createElement("div",{className:"navbar-header"},n.createElement("div",{className:"navbar-brand"},"Firehose")),n.createElement("ul",{className:"nav navbar-nav navbar-right"},e,n.createElement("li",null,n.createElement("span",null,n.createElement(i,{loggedIn:this.state.loggedIn,onLoggedIn:this.handleLoggedIn,onLoggedOut:this.handleLoggedOut,signInLabel:"Sign In",signOutLabel:"Sign Out"}))))))}});t.exports=s},{"./ViewToggle.jsx":6,"./WebmakerLoginUX.jsx":7}],6:[function(e,t){"use strict";var n=window.React,i=n.createClass({displayName:"ViewToggle",onToggle:function(){var e="one-up"===this.props.viewState?"grid":"one-up";this.props.onToggle(e)},render:function(){var e="firehose-toggle ";return e+="one-up"===this.props.viewState?"one-up-enabled right":"grid-enabled left",n.createElement("li",null,n.createElement("span",{onClick:this.onToggle,className:e},n.createElement("i",{className:"fa fa-th-large firehose-toggle-icon"}),n.createElement("div",{className:"firehose-slider-container"},n.createElement("div",{className:"firehose-slider"})),n.createElement("i",{className:"fa fa-square-o firehose-toggle-icon"})))}});t.exports=i},{}],7:[function(e,t){"use strict";var n=window.React,i=e("./../../mixins/WebmakerUXMixin"),r=n.createClass({displayName:"WebmakerLoginUX",mixins:[i],render:function(){var e=this.login,t=this.props.signInLabel;return this.props.loggedIn&&(e=this.logout,t=this.props.signOutLabel),n.createElement("button",{className:"btn btn-primary webmaker-login-ux",onClick:e},t)}});t.exports=r},{"./../../mixins/WebmakerUXMixin":18}],8:[function(e,t){"use strict";var n=window.React,i=e("../../actions/FirehoseActions"),r=e("../../actions/FirehoseConstants"),s=n.createClass({displayName:"FeatureMake",componentDidMount:function(){i.addListener(r.TOGGLE_FEATURE,this.onFeaturedClicked)},componentWillUnmount:function(){i.deleteListener(r.TOGGLE_FEATURE,this.onFeaturedClicked)},onFeaturedClicked:function(){this.props.onFeaturedClicked()},render:function(){var e="feature-toggle fa ";return e+=this.props.featured?"fa-star":"fa-star-o",n.createElement("i",{className:e,onClick:this.onFeaturedClicked,title:"Toggle with 'f' or Spacebar"})}});t.exports=s},{"../../actions/FirehoseActions":1,"../../actions/FirehoseConstants":2}],9:[function(e,t){"use strict";var n=window.React,i=e("../../actions/FirehoseActions"),r=e("../../actions/FirehoseConstants"),s=n.createClass({displayName:"Navigate",componentDidMount:function(){i.addListener(r.NAVIGATE,this.handleKeyboardEvent)},componentWillUnmount:function(){i.deleteListener(r.NAVIGATE,this.handleKeyboardEvent)},handleKeyboardEvent:function(e){e===this.props.delta&&this.props.onNavigate(this.props.delta)},onNavigate:function(){this.props.onNavigate(this.props.delta)},render:function(){var e="make-nav fa ";return e+=this.props.delta>0?"fa-arrow-right":"fa-arrow-left",n.createElement("i",{className:e,onClick:this.onNavigate,title:"You can control the current make with the arrow keys"})}});t.exports=s},{"../../actions/FirehoseActions":1,"../../actions/FirehoseConstants":2}],10:[function(e,t){"use strict";var n=window.React,i=e("../../actions/FirehoseActions"),r=e("../../actions/FirehoseConstants"),s=n.createClass({displayName:"Trash",componentDidMount:function(){i.addListener(r.TRASH,this.props.onTrashClicked)},componentWillUnmount:function(){i.deleteListener(r.TRASH,this.props.onTrashClicked)},render:function(){return n.createElement("i",{onClick:this.props.onTrashClicked,className:"firehose-trash-make fa fa-trash-o",title:"You can trash makes with the 'd' or Backspace key"})}});t.exports=s},{"../../actions/FirehoseActions":1,"../../actions/FirehoseConstants":2}],11:[function(e,t){"use strict";var n=window.React,i=e("./OneUpView.jsx"),r=e("./GridView.jsx"),s=n.createClass({displayName:"FirehoseEditor",render:function(){var e;return e="one-up"===this.props.viewState?n.createElement(i,{searchPage:this.props.initialSearchPage,makeIdx:this.props.initialMakeIdx,make:this.props.make,csrfToken:this.props.csrfToken}):n.createElement(r,null),n.createElement("div",{className:"container"},e)}});t.exports=s},{"./GridView.jsx":12,"./OneUpView.jsx":15}],12:[function(e,t){"use strict";var n=window.React,i=n.createClass({displayName:"GridView",render:function(){var e={width:"100%"};return n.createElement("div",{className:"container"},n.createElement("h3",null,"Under Construction"),n.createElement("img",{style:e,src:"http://people.mozilla.org/~smartell/blog/dino-wallpaper.png",alt:"GRID VIEW UNDER CONSTRUCTION"}))}});t.exports=i},{}],13:[function(e,t){"use strict";var n=window.React,i=e("../shared/Trash.jsx"),r=e("../shared/Feature.jsx"),s=e("../shared/Navigate.jsx"),o=e("./MakePreview.jsx"),a=n.createClass({displayName:"MakeDetails",onNavigate:function(e){this.props.onNavigate(e)},onFeaturedClicked:function(){this.props.onFeaturedClicked()},render:function(){var e=this;if(!this.props.make)return n.createElement("div",{className:"container"},n.createElement("h2",null,"No Make Data!?"));var t="https://secure.gravatar.com/avatar/"+this.props.make.emailHash,a=!!this.props.make.tags.find(function(t){return t===e.props.featuredTagName}),l="https://webmaker.org/u/"+this.props.make.username;return n.createElement("div",{className:"container"},n.createElement("div",{className:"firehose-make-details"},n.createElement("img",{className:"firehose-make-avatar",src:t,alt:"https://stuff.webmaker.org/avatars/webmaker-avatar-200x200.png"}),n.createElement("div",{className:"firehose-make-info col-md-6 col-xs-6"},n.createElement("div",{className:"firehose-make-title"},this.props.make.title),n.createElement("div",null,n.createElement("a",{className:"firehose-make-username",href:l},"@",this.props.make.username))),n.createElement("div",{className:"firehose-one-up-controls col-md-5 col-xs-5"},n.createElement(i,{onTrashClicked:this.props.onTrashClicked}),n.createElement(r,{onFeaturedClicked:this.onFeaturedClicked,featured:a}),n.createElement(s,{onNavigate:this.onNavigate,delta:-1}),n.createElement(s,{onNavigate:this.onNavigate,delta:1}))),n.createElement(o,{url:this.props.make.url}))}});t.exports=a},{"../shared/Feature.jsx":8,"../shared/Navigate.jsx":9,"../shared/Trash.jsx":10,"./MakePreview.jsx":14}],14:[function(e,t){"use strict";var n=window.React,i=n.createClass({displayName:"MakePreview",render:function(){var e,t=this.props.url,i=/^https/;return e=!i.test(window.location)||i.test(t)?n.createElement("iframe",{src:t,className:"make-preview"}):n.createElement("div",{className:"container col-md-12 text-center"},n.createElement("a",{className:"make-preview-link",href:this.props.url,target:"_blank",title:"http links cannot be loaded by iframe due to mixed content blocking"},"Open Make in Tab"))}});t.exports=i},{}],15:[function(e,t){"use strict";var n=window.React,i=e("./MakeDetails.jsx"),r=e("../../mixins/MakeModerationActions.js"),s=n.createClass({displayName:"OneUpView",mixins:[r],getInitialState:function(){return{searchPage:this.props.initialSearchPage||1,index:this.props.initialMakeIdx||0}},render:function(){var e=void 0;return e=this.state.makes?this.state.makes.length?n.createElement("div",null,n.createElement(i,{featuredTagName:"webmaker:featured",make:this.state.makes[this.state.index],onNavigate:this.onNavigate,onFeaturedClicked:this.onFeaturedClicked,onTrashClicked:this.onTrashClicked})):n.createElement("span",{className:"no-makes"},n.createElement("i",{className:"fa fa-exclamation-triangle"}),"There are no makes to display!"):n.createElement("span",{className:"loading-makes"},n.createElement("i",{className:"fa fa-spinner fa-spin"}),"Loading Makes..")}});t.exports=s},{"../../mixins/MakeModerationActions.js":17,"./MakeDetails.jsx":13}],16:[function(e,t){"use strict";var n=e("flux").Dispatcher;t.exports=new n},{flux:30}],17:[function(e,t){"use strict";var n=e("superagent"),i=window.toastr;i.options={timeOut:5e3,extendedTimeOut:0,preventDuplicates:!0,positionClass:"toast-top-center"};var r=100,s="/api/1.0",o={componentDidMount:function(){this.getMakeData(this.state.searchPage,this.state.index)},onNavigate:function(e){var t=this.state.index+e;if(t>=r)this.getMakeData(this.state.searchPage+1,0);else if(0>t)this.state.searchPage>1&&this.getMakeData(this.state.searchPage-1,r-1);else{if(!this.state.makes[t])return;this.setState({index:t})}},onTrashClicked:function(){var e=this,t=this.state.makes,r=t[this.state.index],o=t.indexOf(r);i.options.onclick=function(){return e.restore(r,o),!0},n.post(""+s+"/trash").send({id:r.id}).set("X-CSRF-Token",this.props.csrfToken).type("application/json").on("error",function(e){return console.error(e)}).end(function(){var n=e.state.index;t.splice(o,1),0!==n&&n>t.length-1&&n--,i.error("<strong>Click To Undo</strong>","<strong>Make Deleted</strong>"),e.setState({makes:t,index:n})})},onFeaturedClicked:function(){var e=this,t=this.state.makes,i=t[this.state.index];n.post(""+s+"/feature").send({id:i.id,featured:-1!==i.tags.indexOf("webmaker:featured")}).set("X-CSRF-Token",this.props.csrfToken).type("application/json").on("error",function(e){return console.error(e)}).end(function(n){i.tags=n.body.tags,e.setState({makes:t})})},getMakeData:function(e,t){var i=this;n.get(""+s+"/find?p="+e+"&nocache="+Date.now()).on("error",function(e){return console.error(e)}).end(function(n){i.setState({searchPage:e,index:t,makes:n.body})})},restore:function(e,t){var i=this;n.post(""+s+"/restore?nocache="+Date.now()).send({id:e.id}).set("X-CSRF-Token",this.props.csrfToken).type("application/json").on("error",function(e){return console.error(e)}).end(function(){i.state.makes.splice(t,0,e),i.setState({makes:i.state.makes})})}};t.exports=o},{superagent:34}],18:[function(e,t){"use strict";var n={componentDidMount:function(){var t=e("webmaker-login-ux"),n=new t({csrfToken:document.querySelector('meta[name="csrf-token"]').getAttribute("content"),disablePersona:!0});n.on("login",this.loggedIn),n.on("logout",this.loggedOut),n.on("verified",function(e){e?n.emit("login",e):n.emit("logout")}),this.auth=n},loggedIn:function(e){this.props.onLoggedIn(e)},loggedOut:function(){this.props.onLoggedOut()},login:function(){this.auth.login()},logout:function(){this.auth.logout()}};t.exports=n},{"webmaker-login-ux":44}],19:[function(){!function(){if(!Array.prototype.find){var e=function(e){var t=Object(this),n=t.length<0?0:t.length>>>0;if(0===n)return void 0;if("function"!=typeof e||"[object Function]"!==Object.prototype.toString.call(e))throw new TypeError("Array#find: predicate must be a function");for(var i,r=arguments[1],s=0;n>s;s++)if(i=t[s],e.call(r,i,s,t))return i;return void 0};if(Object.defineProperty)try{Object.defineProperty(Array.prototype,"find",{value:e,configurable:!0,enumerable:!1,writable:!0})}catch(t){}Array.prototype.find||(Array.prototype.find=e)}}(this)},{}],20:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function r(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,r,a,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],o(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),l=1;r>l;l++)a[l-1]=arguments[l];n.apply(this,a)}else if(s(n)){for(r=arguments.length,a=new Array(r-1),l=1;r>l;l++)a[l-1]=arguments[l];for(c=n.slice(),r=c.length,l=0;r>l;l++)c[l].apply(this,a)}return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var r;r=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,r,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=o;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],21:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(e,t){function n(){if(!o){o=!0;for(var e,t=s.length;t;){e=s,s=[];for(var n=-1;++n<t;)e[n]();t=s.length}o=!1}}function i(){}var r=t.exports={},s=[],o=!1;r.nextTick=function(e){s.push(e),o||setTimeout(n,0)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.on=i,r.addListener=i,r.once=i,r.off=i,r.removeListener=i,r.removeAllListeners=i,r.emit=i,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],23:[function(e,t,n){(function(e){!function(i){function r(e){throw RangeError(M[e])}function s(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function o(e,t){return s(e.split(N),t).join(".")}function a(e){for(var t,n,i=[],r=0,s=e.length;s>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&s>r?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--)):i.push(t);return i}function l(e){return s(e,function(e){var t="";return e>65535&&(e-=65536,t+=j(e>>>10&1023|55296),e=56320|1023&e),t+=j(e)}).join("")}function c(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:x}function u(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function h(e,t,n){var i=0;for(e=n?P(e/S):e>>1,e+=P(e/t);e>F*T>>1;i+=x)e=P(e/F);return P(i+(F+1)*e/(e+A))}function d(e){var t,n,i,s,o,a,u,d,p,f,m=[],g=e.length,v=0,y=C,b=L;for(n=e.lastIndexOf(O),0>n&&(n=0),i=0;n>i;++i)e.charCodeAt(i)>=128&&r("not-basic"),m.push(e.charCodeAt(i));for(s=n>0?n+1:0;g>s;){for(o=v,a=1,u=x;s>=g&&r("invalid-input"),d=c(e.charCodeAt(s++)),(d>=x||d>P((k-v)/a))&&r("overflow"),v+=d*a,p=b>=u?E:u>=b+T?T:u-b,!(p>d);u+=x)f=x-p,a>P(k/f)&&r("overflow"),a*=f;t=m.length+1,b=h(v-o,t,0==o),P(v/t)>k-y&&r("overflow"),y+=P(v/t),v%=t,m.splice(v++,0,y)}return l(m)}function p(e){var t,n,i,s,o,l,c,d,p,f,m,g,v,y,b,w=[];for(e=a(e),g=e.length,t=C,n=0,o=L,l=0;g>l;++l)m=e[l],128>m&&w.push(j(m));for(i=s=w.length,s&&w.push(O);g>i;){for(c=k,l=0;g>l;++l)m=e[l],m>=t&&c>m&&(c=m);for(v=i+1,c-t>P((k-n)/v)&&r("overflow"),n+=(c-t)*v,t=c,l=0;g>l;++l)if(m=e[l],t>m&&++n>k&&r("overflow"),m==t){for(d=n,p=x;f=o>=p?E:p>=o+T?T:p-o,!(f>d);p+=x)b=d-f,y=x-f,w.push(j(u(f+b%y,0))),d=P(b/y);w.push(j(u(d,0))),o=h(n,v,i==s),n=0,++i}++n,++t}return w.join("")}function f(e){return o(e,function(e){return _.test(e)?d(e.slice(4).toLowerCase()):e})}function m(e){return o(e,function(e){return R.test(e)?"xn--"+p(e):e})}var g="object"==typeof n&&n,v="object"==typeof t&&t&&t.exports==g&&t,y="object"==typeof e&&e;(y.global===y||y.window===y)&&(i=y);var b,w,k=2147483647,x=36,E=1,T=26,A=38,S=700,L=72,C=128,O="-",_=/^xn--/,R=/[^ -~]/,N=/\x2E|\u3002|\uFF0E|\uFF61/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},F=x-E,P=Math.floor,j=String.fromCharCode;if(b={version:"1.2.4",ucs2:{decode:a,encode:l},decode:d,encode:p,toASCII:m,toUnicode:f},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return b});else if(g&&!g.nodeType)if(v)v.exports=b;else for(w in b)b.hasOwnProperty(w)&&(g[w]=b[w]);else i.punycode=b}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],24:[function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,s){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var l=1e3;s&&"number"==typeof s.maxKeys&&(l=s.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;c>u;++u){var h,d,p,f,m=e[u].replace(a,"%20"),g=m.indexOf(r);g>=0?(h=m.substr(0,g),d=m.substr(g+1)):(h=m,d=""),p=decodeURIComponent(h),f=decodeURIComponent(d),n(o,p)?i(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],25:[function(e,t){"use strict";function n(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,o,a){return t=t||"&",o=o||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var a=encodeURIComponent(i(s))+o;return r(e[s])?n(e[s],function(e){return a+encodeURIComponent(i(e))}).join(t):a+encodeURIComponent(i(e[s]))}).join(t):a?encodeURIComponent(i(a))+o+encodeURIComponent(i(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],26:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":24,"./encode":25}],27:[function(e,t,n){function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(e,t,n){if(e&&c(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}function s(e){return l(e)&&(e=r(e)),e instanceof i?e.format():i.prototype.format.call(e)}function o(e,t){return r(e,!1,!0).resolve(t)}function a(e,t){return e?r(e,!1,!0).resolveObject(t):t}function l(e){return"string"==typeof e}function c(e){return"object"==typeof e&&null!==e}function u(e){return null===e}function h(e){return null==e}var d=e("punycode");n.parse=r,n.resolve=o,n.resolveObject=a,n.format=s,n.Url=i;var p=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],g=["{","}","|","\\","^","`"].concat(m),v=["'"].concat(g),y=["%","/","?",";","#"].concat(v),b=["/","?","#"],w=255,k=/^[a-z0-9A-Z_-]{0,63}$/,x=/^([a-z0-9A-Z_-]{0,63})(.*)$/,E={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=e("querystring");i.prototype.parse=function(e,t,n){if(!l(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e;i=i.trim();var r=p.exec(i);if(r){r=r[0];var s=r.toLowerCase();this.protocol=s,i=i.substr(r.length)}if(n||r||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var o="//"===i.substr(0,2);!o||r&&T[r]||(i=i.substr(2),this.slashes=!0)}if(!T[r]&&(o||r&&!A[r])){for(var a=-1,c=0;c<b.length;c++){var u=i.indexOf(b[c]);-1!==u&&(-1===a||a>u)&&(a=u)}var h,f;f=-1===a?i.lastIndexOf("@"):i.lastIndexOf("@",a),-1!==f&&(h=i.slice(0,f),i=i.slice(f+1),this.auth=decodeURIComponent(h)),a=-1;for(var c=0;c<y.length;c++){var u=i.indexOf(y[c]);-1!==u&&(-1===a||a>u)&&(a=u)}-1===a&&(a=i.length),this.host=i.slice(0,a),i=i.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var g=this.hostname.split(/\./),c=0,L=g.length;L>c;c++){var C=g[c];if(C&&!C.match(k)){for(var O="",_=0,R=C.length;R>_;_++)O+=C.charCodeAt(_)>127?"x":C[_];if(!O.match(k)){var N=g.slice(0,c),M=g.slice(c+1),F=C.match(x);F&&(N.push(F[1]),M.unshift(F[2])),M.length&&(i="/"+M.join(".")+i),this.hostname=N.join(".");break}}}if(this.hostname=this.hostname.length>w?"":this.hostname.toLowerCase(),!m){for(var P=this.hostname.split("."),j=[],c=0;c<P.length;++c){var D=P[c];j.push(D.match(/[^A-Za-z0-9_-]/)?"xn--"+d.encode(D):D)}this.hostname=j.join(".")}var I=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+I,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!E[s])for(var c=0,L=v.length;L>c;c++){var q=v[c],K=encodeURIComponent(q);K===q&&(K=escape(q)),i=i.split(q).join(K)}var B=i.indexOf("#");-1!==B&&(this.hash=i.substr(B),i=i.slice(0,B));var G=i.indexOf("?");if(-1!==G?(this.search=i.substr(G),this.query=i.substr(G+1),t&&(this.query=S.parse(this.query)),i=i.slice(0,G)):t&&(this.search="",this.query={}),i&&(this.pathname=i),A[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var I=this.pathname||"",D=this.search||"";this.path=I+D}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,s="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(s=S.stringify(this.query));var o=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||A[t])&&r!==!1?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),o=o.replace("#","%23"),t+r+n+o+i},i.prototype.resolve=function(e){return this.resolveObject(r(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(l(e)){var t=new i;t.parse(e,!1,!0),e=t}var n=new i;if(Object.keys(this).forEach(function(e){n[e]=this[e]},this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(n[t]=e[t])}),A[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!A[e.protocol])return Object.keys(e).forEach(function(t){n[t]=e[t]}),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||T[e.protocol])n.pathname=e.pathname;else{for(var r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var s=n.pathname||"",o=n.search||"";n.path=s+o}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),c=e.host||e.pathname&&"/"===e.pathname.charAt(0),d=c||a||n.host&&e.pathname,p=d,f=n.pathname&&n.pathname.split("/")||[],r=e.pathname&&e.pathname.split("/")||[],m=n.protocol&&!A[n.protocol];if(m&&(n.hostname="",n.port=null,n.host&&(""===f[0]?f[0]=n.host:f.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),d=d&&(""===r[0]||""===f[0])),c)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,f=r;else if(r.length)f||(f=[]),f.pop(),f=f.concat(r),n.search=e.search,n.query=e.query;else if(!h(e.search)){if(m){n.hostname=n.host=f.shift();var g=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;g&&(n.auth=g.shift(),n.host=n.hostname=g.shift())}return n.search=e.search,n.query=e.query,u(n.pathname)&&u(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!f.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var v=f.slice(-1)[0],y=(n.host||e.host)&&("."===v||".."===v)||""===v,b=0,w=f.length;w>=0;w--)v=f[w],"."==v?f.splice(w,1):".."===v?(f.splice(w,1),b++):b&&(f.splice(w,1),b--);if(!d&&!p)for(;b--;b)f.unshift("..");!d||""===f[0]||f[0]&&"/"===f[0].charAt(0)||f.unshift(""),y&&"/"!==f.join("/").substr(-1)&&f.push("");var k=""===f[0]||f[0]&&"/"===f[0].charAt(0);if(m){n.hostname=n.host=k?"":f.length?f.shift():"";var g=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;g&&(n.auth=g.shift(),n.host=n.hostname=g.shift())}return d=d||n.host&&f.length,d&&!k&&f.unshift(""),f.length?n.pathname=f.join("/"):(n.pathname=null,n.path=null),u(n.pathname)&&u(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:23,querystring:26}],28:[function(e,t){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],29:[function(e,t,n){(function(t,i){function r(e,t){var i={seen:[],stylize:o};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(t)?i.showHidden=t:t&&n._extend(i,t),k(i.showHidden)&&(i.showHidden=!1),k(i.depth)&&(i.depth=2),k(i.colors)&&(i.colors=!1),k(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=s),l(i,e,i.depth)}function s(e,t){var n=r.styles[t];return n?"["+r.colors[n][0]+"m"+e+"["+r.colors[n][1]+"m":e}function o(e){return e}function a(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function l(e,t,i){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(i,e);return b(r)||(r=l(e,r,i)),r}var s=c(e,t);if(s)return s;
var o=Object.keys(t),m=a(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),A(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return u(t);if(0===o.length){if(S(t)){var g=t.name?": "+t.name:"";return e.stylize("[Function"+g+"]","special")}if(x(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(T(t))return e.stylize(Date.prototype.toString.call(t),"date");if(A(t))return u(t)}var v="",y=!1,w=["{","}"];if(f(t)&&(y=!0,w=["[","]"]),S(t)){var k=t.name?": "+t.name:"";v=" [Function"+k+"]"}if(x(t)&&(v=" "+RegExp.prototype.toString.call(t)),T(t)&&(v=" "+Date.prototype.toUTCString.call(t)),A(t)&&(v=" "+u(t)),0===o.length&&(!y||0==t.length))return w[0]+v+w[1];if(0>i)return x(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var E;return E=y?h(e,t,i,m,o):o.map(function(n){return d(e,t,i,m,n,y)}),e.seen.pop(),p(E,v,w)}function c(e,t){if(k(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,i,r){for(var s=[],o=0,a=t.length;a>o;++o)s.push(R(t,String(o))?d(e,t,n,i,String(o),!0):"");return r.forEach(function(r){r.match(/^\d+$/)||s.push(d(e,t,n,i,r,!0))}),s}function d(e,t,n,i,r,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),R(i,r)||(o="["+r+"]"),a||(e.seen.indexOf(c.value)<0?(a=g(n)?l(e,c.value,null):l(e,c.value,n-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),k(o)){if(s&&r.match(/^\d+$/))return a;o=JSON.stringify(""+r),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function p(e,t,n){var i=0,r=e.reduce(function(e,t){return i++,t.indexOf("\n")>=0&&i++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function f(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function g(e){return null===e}function v(e){return null==e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function k(e){return void 0===e}function x(e){return E(e)&&"[object RegExp]"===C(e)}function E(e){return"object"==typeof e&&null!==e}function T(e){return E(e)&&"[object Date]"===C(e)}function A(e){return E(e)&&("[object Error]"===C(e)||e instanceof Error)}function S(e){return"function"==typeof e}function L(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function C(e){return Object.prototype.toString.call(e)}function O(e){return 10>e?"0"+e.toString(10):e.toString(10)}function _(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var N=/%[sdj%]/g;n.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(r(arguments[n]));return t.join(" ")}for(var n=1,i=arguments,s=i.length,o=String(e).replace(N,function(e){if("%%"===e)return"%";if(n>=s)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return e}}),a=i[n];s>n;a=i[++n])o+=g(a)||!E(a)?" "+a:" "+r(a);return o},n.deprecate=function(e,r){function s(){if(!o){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),o=!0}return e.apply(this,arguments)}if(k(i.process))return function(){return n.deprecate(e,r).apply(this,arguments)};if(t.noDeprecation===!0)return e;var o=!1;return s};var M,F={};n.debuglog=function(e){if(k(M)&&(M=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!F[e])if(new RegExp("\\b"+e+"\\b","i").test(M)){var i=t.pid;F[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,i,t)}}else F[e]=function(){};return F[e]},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=m,n.isNull=g,n.isNullOrUndefined=v,n.isNumber=y,n.isString=b,n.isSymbol=w,n.isUndefined=k,n.isRegExp=x,n.isObject=E,n.isDate=T,n.isError=A,n.isFunction=S,n.isPrimitive=L,n.isBuffer=e("./support/isBuffer");var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",_(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!E(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":28,_process:22,inherits:21}],30:[function(e,t){t.exports.Dispatcher=e("./lib/Dispatcher")},{"./lib/Dispatcher":31}],31:[function(e,t){"use strict";function n(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}var i=e("./invariant"),r=1,s="ID_";n.prototype.register=function(e){var t=s+r++;return this.$Dispatcher_callbacks[t]=e,t},n.prototype.unregister=function(e){i(this.$Dispatcher_callbacks[e],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",e),delete this.$Dispatcher_callbacks[e]},n.prototype.waitFor=function(e){i(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var t=0;t<e.length;t++){var n=e[t];this.$Dispatcher_isPending[n]?i(this.$Dispatcher_isHandled[n],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n):(i(this.$Dispatcher_callbacks[n],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this.$Dispatcher_invokeCallback(n))}},n.prototype.dispatch=function(e){i(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(e);try{for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]||this.$Dispatcher_invokeCallback(t)}finally{this.$Dispatcher_stopDispatching()}},n.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},n.prototype.$Dispatcher_invokeCallback=function(e){this.$Dispatcher_isPending[e]=!0,this.$Dispatcher_callbacks[e](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[e]=!0},n.prototype.$Dispatcher_startDispatching=function(e){for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]=!1,this.$Dispatcher_isHandled[t]=!1;this.$Dispatcher_pendingPayload=e,this.$Dispatcher_isDispatching=!0},n.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1},t.exports=n},{"./invariant":32}],32:[function(e,t){"use strict";var n=function(e,t,n,i,r,s,o,a){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,r,s,o,a],u=0;l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[u++]}))}throw l.framesToPop=1,l}};t.exports=n},{}],33:[function(e,t){"use strict";function n(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e){for(var t,i,r=n(e),s=1;s<arguments.length;s++){t=arguments[s],i=Object.keys(Object(t));for(var o=0;o<i.length;o++)r[i[o]]=t[i[o]]}return r}},{}],34:[function(e,t){function n(){}function i(e){var t={}.toString.call(e);switch(t){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function r(){if(g.XMLHttpRequest&&("file:"!=g.location.protocol||!g.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}function s(e){return e===Object(e)}function o(e){if(!s(e))return e;var t=[];for(var n in e)null!=e[n]&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}function a(e){for(var t,n,i={},r=e.split("&"),s=0,o=r.length;o>s;++s)n=r[s],t=n.split("="),i[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return i}function l(e){var t,n,i,r,s=e.split(/\r?\n/),o={};s.pop();for(var a=0,l=s.length;l>a;++a)n=s[a],t=n.indexOf(":"),i=n.slice(0,t).toLowerCase(),r=v(n.slice(t+1)),o[i]=r;return o}function c(e){return e.split(/ *; */).shift()}function u(e){return m(e.split(/ *; */),function(e,t){var n=t.split(/ *= */),i=n.shift(),r=n.shift();return i&&r&&(e[i]=r),e},{})}function h(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method?this.xhr.responseText:null,this.setStatusProperties(this.xhr.status),this.header=this.headers=l(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function d(e,t){var n=this;f.call(this),this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new h(n)}catch(i){e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=i}n.callback(e,t)})}function p(e,t){return"function"==typeof t?new d("GET",e).end(t):1==arguments.length?new d("GET",e):new d(e,t)}var f=e("emitter"),m=e("reduce"),g="undefined"==typeof window?this:window,v="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};p.serializeObject=o,p.parseString=a,p.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},p.serialize={"application/x-www-form-urlencoded":o,"application/json":JSON.stringify},p.parse={"application/x-www-form-urlencoded":a,"application/json":JSON.parse},h.prototype.get=function(e){return this.header[e.toLowerCase()]},h.prototype.setHeaderProperties=function(){var e=this.header["content-type"]||"";this.type=c(e);var t=u(e);for(var n in t)this[n]=t[n]},h.prototype.parseBody=function(e){var t=p.parse[this.type];return t&&e&&e.length?t(e):null},h.prototype.setStatusProperties=function(e){var t=e/100|0;this.status=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=4==t||5==t?this.toError():!1,this.accepted=202==e,this.noContent=204==e||1223==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},h.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,i="cannot "+t+" "+n+" ("+this.status+")",r=new Error(i);return r.status=this.status,r.method=t,r.url=n,r},p.Response=h,f(d.prototype),d.prototype.use=function(e){return e(this),this},d.prototype.timeout=function(e){return this._timeout=e,this},d.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},d.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},d.prototype.set=function(e,t){if(s(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},d.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},d.prototype.getHeader=function(e){return this._header[e.toLowerCase()]},d.prototype.type=function(e){return this.set("Content-Type",p.types[e]||e),this},d.prototype.accept=function(e){return this.set("Accept",p.types[e]||e),this},d.prototype.auth=function(e,t){var n=btoa(e+":"+t);return this.set("Authorization","Basic "+n),this},d.prototype.query=function(e){return"string"!=typeof e&&(e=o(e)),e&&this._query.push(e),this},d.prototype.field=function(e,t){return this._formData||(this._formData=new FormData),this._formData.append(e,t),this},d.prototype.attach=function(e,t,n){return this._formData||(this._formData=new FormData),this._formData.append(e,t,n),this},d.prototype.send=function(e){var t=s(e),n=this.getHeader("Content-Type");if(t&&s(this._data))for(var i in e)this._data[i]=e[i];else"string"==typeof e?(n||this.type("form"),n=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return t?(n||this.type("json"),this):this},d.prototype.callback=function(e,t){var n=this._callback;return this.clearTimeout(),2==n.length?n(e,t):e?this.emit("error",e):void n(t)},d.prototype.crossDomainError=function(){var e=new Error("Origin is not allowed by Access-Control-Allow-Origin");e.crossDomain=!0,this.callback(e)},d.prototype.timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},d.prototype.withCredentials=function(){return this._withCredentials=!0,this},d.prototype.end=function(e){var t=this,s=this.xhr=r(),o=this._query.join("&"),a=this._timeout,l=this._formData||this._data;if(this._callback=e||n,s.onreadystatechange=function(){return 4==s.readyState?0==s.status?t.aborted?t.timeoutError():t.crossDomainError():void t.emit("end"):void 0},s.upload&&(s.upload.onprogress=function(e){e.percent=e.loaded/e.total*100,t.emit("progress",e)}),a&&!this._timer&&(this._timer=setTimeout(function(){t.abort()},a)),o&&(o=p.serializeObject(o),this.url+=~this.url.indexOf("?")?"&"+o:"?"+o),s.open(this.method,this.url,!0),this._withCredentials&&(s.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof l&&!i(l)){var c=p.serialize[this.getHeader("Content-Type")];c&&(l=c(l))}for(var u in this.header)null!=this.header[u]&&s.setRequestHeader(u,this.header[u]);return this.emit("request",this),s.send(l),this},p.Request=d,p.get=function(e,t,n){var i=p("GET",e);return"function"==typeof t&&(n=t,t=null),t&&i.query(t),n&&i.end(n),i},p.head=function(e,t,n){var i=p("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},p.del=function(e,t){var n=p("DELETE",e);return t&&n.end(t),n},p.patch=function(e,t,n){var i=p("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},p.post=function(e,t,n){var i=p("POST",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},p.put=function(e,t,n){var i=p("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},t.exports=p},{emitter:35,reduce:36}],35:[function(e,t){function n(e){return e?i(e):void 0}function i(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===t||i.fn===t){n.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var i=0,r=n.length;r>i;++i)n[i].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],36:[function(e,t){t.exports=function(e,t,n){for(var i=0,r=e.length,s=3==arguments.length?n:e[i++];r>i;)s=t.call(null,s,e[i],++i,e);return s}},{}],37:[function(e,t){t.exports={webmakerAuthWelcome:{message:"Welcome to Webmaker!",description:"Welcome message for the join Webmaker modal dialog. Displayed after successfully creating a new Webmaker account"},webmakerAuthServerError:{message:'An unknown error occurred on the server. Try your request again. If the problem persists, <a class="alert-link" href="https://support.mozilla.org/kb/webmaker-account-help" target="_">get help</a>.',description:"Error message displayed if an error occurs on the server."},webmakerAuthCreateWelcome:{message:"Create A Webmaker Account",description:"Header text for the join webmaker modal dialog"},webmakerAuthChooseUsername:{message:"Choose A Username",description:"Label text for the username selection input"},webmakerAuthTakenError:{message:'<i class="fa fa-times"></i> That username is taken. Try adding your favourite number at the end.',description:"Error message displayed when the entered username is not available for use."},webmakerAuthUsernameInvalid:{message:'<i class="fa fa-times"></i>  <strong>Uh oh!</strong> All usernames must be between 1-20 characters, and only include "-" and alphanumeric symbols',description:"Error message displayed when the username entered contains symbols that are not allowed."},webmakerAuthMailingList:{message:"Send me email updates about Webmaker and other Mozilla projects",description:"Message about opting in for a Mozilla mailing list"},webmakerAuthAgreeToTerms:{message:"I agree to Mozilla Webmaker's <a href='https://webmaker.org/terms'>Terms</a> and <a href='https://webmaker.org/privacy'>Privacy Policy</a>",description:"I agree to Mozilla Webmaker's terms and privacy policy."},webmakerAuthAgreeError:{message:'<i class="fa fa-times"></i>  <strong>Oh snap!</strong> You must agree to our terms and conditions.',description:"Error message displayed if the terms and conditions checkbox isn't toggled on."},webmakerAuthCreateAccount:{message:"Create Account",description:"The button text for finishing the join Webmaker process."},Cancel:{message:"Cancel",description:"Cancel button text"},Email:{message:"Enter Your Email",description:"Label text for the email input"},EmailOrUsername:{message:"Email or Username",description:"Label text for the sign in input, asks for the username or email of the user's account."},NotAnEmail:{message:'<i class="fa fa-times"></i>  <strong>Uh Oh!</strong> That doesn\'t look like an email address.',description:"Error message when the text entered in an email input is not an email address"},WebmakerAccountExists:{message:'<i class="fa fa-exclamation-circle"></i>  <strong>Heads up!</strong> That email already has an account. Did you mean to <a href="#" class="alert-link" ng-click="switchToSignin();">sign in</a>?',description:"That email already has an accout. Did you mean to sign in?"},ChooseUsername:{message:"Choose Username",description:" Label text for selecting a username"},"Language Preference":{message:"Language Preference",description:"Label text for selecting the preferred language for the user."},"Sign in to Webmaker":{message:"Sign In To Webmaker",description:"Header text for the sign in modal dialog"},"Sign in":{message:"Sign In",description:"Sign in Button text"},"Sign up":{message:"Join",description:"Join button text"},passLoginFailed:{message:'<i class="fa fa-times"></i> <strong>Authentication failed!</strong>',description:"Error message when a password login attempt fails"},resetMessage:{message:"Check your email for a password reset link.",description:"Directs the user to check their email for a password reset link"},resetRequestFailed:{message:'<i class="fa fa-times"></i> <strong>Uh oh!</strong> Something went wrong! Try requesting the password reset again. Or, <a class="alert-link" href="https://support.mozilla.org/kb/webmaker-account-help" target="_">get help</a>.',description:"Error displayed if a password reset request fails."},Password:{message:"Password",description:"Label text for the password input"},"Forgot your password?":{message:"Forgot your password?",description:"button text for the password reset function"},checkEmail:{message:"Check Your Email",description:"Message instructing the user to check their email"},tokenMessage:{message:"Please check your email to confirm your account.",description:"Message instructing the user to check their email for an account confirmation link"},"That does not look like an email address or username":{message:'<i class="fa fa-times"></i> <strong>Uh oh!</strong> That doesn\'t look like an email address or username.',description:"Error message displayed when the input doesn't match a username or email"},"No account found for your uid":{message:'<i class="fa fa-times"></i> We couldn\'t find your username or email address. Did you mean to <a href="#" ng-click="switchToSignup();" class="alert-link">create an account</a>? Trouble? <a class="alert-link" href="https://support.mozilla.org/kb/webmaker-account-help" target="_">Get help</a>.',description:"Error message displayed when the given username or email doesn't have a Webmaker account and asks if they would like to sign up."},"problem sending token":{message:'<i class="fa fa-times"></i> There was a problem sending a login key to you, please try again. <a class="alert-link" href="https://support.mozilla.org/kb/webmaker-account-help" target="_">Get help</a>.',description:"Error message displayed when the request for a login key fails for some reason."},incorrectToken:{message:'<i class="fa fa-times"></i> <strong>Uh oh!</strong> That key is not correct.',description:"Error message displayed when the token used to log in is rejected."},"Visit Email":{message:"Visit your email to retrieve your key",description:"Label text above the login key input field"},"Verified Visit Email":{message:"We emailed you a link & key to sign in",description:"Message instructing the user to check their email for an account confirmation link"},"Enter key":{message:'Enter key <i class="fa fa-angle-right"></i>',description:"Label to enter key that was sent to user's email"},"you can switch to webmaker login":{message:"You can switch back to our Webmaker Login experience. We will send you login emails so you do not need a password.",description:"Message reminding users that they can switch back to the Webmaker Login Key system instead of using a password."},Submit:{message:"Submit",description:"Label text for the submit new password button in the Reset Password Modal Dialog"},or:{message:"or",description:"Text beside the button that initiates a persona login"},"log in with Persona":{message:"log in with Persona",description:"Text for the button that initiates a persona login"},"trouble with email":{message:'Trouble with email? Check your spam or <a href="https://support.mozilla.org/kb/webmaker-account-help" tabindex="5" target="_">get help</a>',description:"Text that allows users to get help"},aboutWebmaker:{message:"Make your own web pages, interactive videos, remixes and mobile apps.",description:"Short description of Webmaker"},"XRay-Goggles":{message:"X-Ray Goggles",description:"The X-Ray Goggles Tool"},AboutGoggles:{message:"X-Ray Goggles allow you to see and change the building blocks that make up websites on the Internet. Activate the goggles to play with the code behind any webpage.",description:"A short description of the X-Ray Goggles"},TryGoggles:{message:"Try Goggles now",description:"Text for the button that takes the user to the X-Ray Goggles homepage"},ExploreWebmaker:{message:"Explore the rest of Webmaker",description:"Text for the button which takes the user to webmaker.org/explore"},Resources:{message:"Resources",description:"The Resources section of Webmaker"},AboutResources:{message:"Teach and learn digital skills and web literacy. Webmaker Resources are full of fun things to discover, make and teach.",description:"A short description about the Resources section"},VisitResources:{message:"Visit Resources",description:"Text for the button that takes the user to the X-Ray Goggles homepage"},"passwords do not match":{message:'<i class="fa fa-times"></i>  <strong>Uh oh!</strong> The passwords do not match!',description:"Error message displayed when the password input and password confirmation input do not match"},"error setting password":{message:'<i class="fa fa-times"></i>  <strong>Uh oh!</strong> There was an error trying to set your password, please try again.',description:"Error displayed if there was a problem setting the new password"},"Confirm your password":{message:"Confirm Your Password",description:"Label text for the password confirmation input"},"Reset Password":{message:"Reset Password",description:"Reset Password Modal title"},"Set a Password":{message:"Set A Password",description:"Label text for the password input box (reset password modal)"},"Password Reset Success":{message:'<i class="fa fa-check"></i> <strong>Success!</strong> You\'ve successfully reset your password, please sign in!',description:"Alert displayed after successfully resetting a password"},"Password too weak":{message:"<i class=\"fa fa-times\"></i>  <strong>Uh oh!</strong> The password you've entered is too weak. Make sure it doesn't contain any common words or patterns, and doesn't contain your email or username",description:"Error message displayed if the server determined the password entered is too weak."},"Minimum password requirements":{message:"Minimum password requirements",description:"Text above the list of minimum requirements that a password must satisfy"},"At least 8 characters":{message:"At least 8 characters",description:"A password must contain 8 or more characters"},"At least 1 upper and lower case character":{message:"At least 1 uppercase and lowercase character",description:"A password must contain at least 1 upper and lower case character"},"At least 1 number":{message:"At least 1 number",description:"a password must contain at least one number character"},resetRequestFailed:{message:'<i class="fa fa-times"></i>  <strong>Uh oh!</strong> There was a problem processing your request, please try again.',description:"Error message displayed if the reset request fails for some reason"},Next:{message:"Next",description:"Go to the next screen"},Cancel:{message:"Cancel",description:"Cancel sign up or sign in"},Done:{message:"Done",description:"Done, close the window."},"Remember me for one year":{message:"Remember me",description:"Message displayed next to the remember me checkbox"},"Lets Go!":{message:"Let's Go!",description:"Button text for closing the modal dialog after account creation"},"Expired Login Link":{message:"Uh Oh! Your login link expired. Request a new email to sign in.",description:"Error message displayed if a login link is expired"}}},{}],38:[function(e,t,n){"use strict";function i(e){var t;if("string"!=typeof e)throw new TypeError("src must be a string, instead saw '"+typeof e+"'");return i.cache?(t=i.cache[e],t||(t=i.cache[e]=u.parse(e)),t):u.parse(e)}function r(e){return o[e]}var s=e("./parse.js"),o={},a=s.Lexer,l=s.Parser,c=new a({}),u=new l(c,r);i.cache={},n.Lexer=a,n.Parser=l,n.compile=i,n.filters=o},{"./parse.js":39}],39:[function(e,t,n){"use strict";function i(){}function r(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function s(e){return"undefined"!=typeof e}function o(e){return function(){return e}}function a(e,t){var n=arguments;throw t=t.replace(/{(\d)}/g,function(e){return n[2+parseInt(e[1])]}),new SyntaxError(t)}function l(e){return"string"==typeof e?e.toLowerCase():e}function c(e,t){e.forEach(t)}function u(e,t){if("constructor"===e)throw a("isecfld",'Referencing "constructor" field in Angular expressions is disallowed! Expression: {0}',t);return e}function h(e,t){if(e){if(e.constructor===e)throw a("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.document&&e.location&&e.alert&&e.setInterval)throw a("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw a("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t)}return e}function d(e,t,n,i){for(var r,s=t.split("."),o=0;s.length>1;o++){r=u(s.shift(),i);var a=e[r];a||(a={},e[r]=a),e=a}return r=u(s.shift(),i),e[r]=n,n}function p(e,t,n,i,r,s){return u(e,s),u(t,s),u(n,s),u(i,s),u(r,s),function(s,o){var a=o&&o.hasOwnProperty(e)?o:s;return null==a?a:(a=a[e],t?null==a?void 0:(a=a[t],n?null==a?void 0:(a=a[n],i?null==a?void 0:(a=a[i],r?null==a?void 0:a=a[r]:a):a):a):a)}}function f(e,t){return u(e,t),function(t,n){return null==t?void 0:(n&&n.hasOwnProperty(e)?n:t)[e]}}function m(e,t,n){return u(e,n),u(t,n),function(n,i){return null==n?void 0:(n=(i&&i.hasOwnProperty(e)?i:n)[e],null==n?void 0:n[t])}}function g(e,t,n){if(k.hasOwnProperty(e))return k[e];var i,r=e.split("."),s=r.length;if(1===s)i=f(r[0],n);else if(2===s)i=m(r[0],r[1],n);else if(t.csp)i=6>s?p(r[0],r[1],r[2],r[3],r[4],n,t):function(e,i){var o,a=0;do o=p(r[a++],r[a++],r[a++],r[a++],r[a++],n,t)(e,i),i=void 0,e=o;while(s>a);return o};else{var a="var p;\n";c(r,function(e,t){u(e,n),a+="if(s == null) return undefined;\ns="+(t?"s":'((k&&k.hasOwnProperty("'+e+'"))?k:s)')+'["'+e+'"];\n'}),a+="return s;";var l=new Function("s","k","pw",a);l.toString=o(a),i=l}return"hasOwnProperty"!==e&&(k[e]=i),i}var v={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:i,"+":function(e,t,n,i){return n=n(e,t),i=i(e,t),s(n)?s(i)?n+i:n:s(i)?i:void 0},"-":function(e,t,n,i){return n=n(e,t),i=i(e,t),(s(n)?n:0)-(s(i)?i:0)},"*":function(e,t,n,i){return n(e,t)*i(e,t)},"/":function(e,t,n,i){return n(e,t)/i(e,t)},"%":function(e,t,n,i){return n(e,t)%i(e,t)},"^":function(e,t,n,i){return n(e,t)^i(e,t)},"=":i,"===":function(e,t,n,i){return n(e,t)===i(e,t)},"!==":function(e,t,n,i){return n(e,t)!==i(e,t)},"==":function(e,t,n,i){return n(e,t)==i(e,t)},"!=":function(e,t,n,i){return n(e,t)!=i(e,t)},"<":function(e,t,n,i){return n(e,t)<i(e,t)},">":function(e,t,n,i){return n(e,t)>i(e,t)},"<=":function(e,t,n,i){return n(e,t)<=i(e,t)},">=":function(e,t,n,i){return n(e,t)>=i(e,t)},"&&":function(e,t,n,i){return n(e,t)&&i(e,t)},"||":function(e,t,n,i){return n(e,t)||i(e,t)},"&":function(e,t,n,i){return n(e,t)&i(e,t)},"|":function(e,t,n,i){return i(e,t)(e,t,n(e,t))},"!":function(e,t,n){return!n(e,t)}},y={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},b=function(e){this.options=e};b.prototype={constructor:b,lex:function(e){this.text=e,this.index=0,this.ch=void 0,this.lastCh=":",this.tokens=[];for(var t,n=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&"{"===n[0]&&(t=this.tokens[this.tokens.length-1])&&(t.json=-1===t.text.indexOf("."));else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&n.unshift(this.ch),this.is("}]")&&n.shift(),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var i=this.ch+this.peek(),r=i+this.peek(2),s=v[this.ch],o=v[i],a=v[r];a?(this.tokens.push({index:this.index,text:r,fn:a}),this.index+=3):o?(this.tokens.push({index:this.index,text:i,fn:o}),this.index+=2):s?(this.tokens.push({index:this.index,text:this.ch,fn:s,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)
}this.lastCh=this.ch}return this.tokens},is:function(e){return-1!==e.indexOf(this.ch)},was:function(e){return-1!==e.indexOf(this.lastCh)},peek:function(e){var t=e||1;return this.index+t<this.text.length?this.text.charAt(this.index+t):!1},isNumber:function(e){return e>="0"&&"9">=e},isWhitespace:function(e){return" "===e||"\r"===e||"	"===e||"\n"===e||""===e||" "===e},isIdent:function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var i=s(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw a("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,i,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=l(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var i=this.peek();if("e"==n&&this.isExpOperator(i))e+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}e=1*e,this.tokens.push({index:t,text:e,json:!0,fn:function(){return e}})},readIdent:function(){for(var e,t,n,i,s=this,o="",a=this.index;this.index<this.text.length&&(i=this.text.charAt(this.index),"."===i||this.isIdent(i)||this.isNumber(i));)"."===i&&(e=this.index),o+=i,this.index++;if(e)for(t=this.index;t<this.text.length;){if(i=this.text.charAt(t),"("===i){n=o.substr(e-a+1),o=o.substr(0,e-a),this.index=t;break}if(!this.isWhitespace(i))break;t++}var l={index:a,text:o};if(v.hasOwnProperty(o))l.fn=v[o],l.json=v[o];else{var c=g(o,this.options,this.text);l.fn=r(function(e,t){return c(e,t)},{assign:function(e,t){return d(e,o,t,s.text,s.options)}})}this.tokens.push(l),n&&(this.tokens.push({index:e,text:".",json:!1}),this.tokens.push({index:e+1,text:n,json:!1}))},readString:function(e){var t=this.index;this.index++;for(var n="",i=e,r=!1;this.index<this.text.length;){var s=this.text.charAt(this.index);if(i+=s,r){if("u"===s){var o=this.text.substring(this.index+1,this.index+5);o.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+o+"]"),this.index+=4,n+=String.fromCharCode(parseInt(o,16))}else{var a=y[s];n+=a?a:s}r=!1}else if("\\"===s)r=!0;else{if(s===e)return this.index++,void this.tokens.push({index:t,text:i,string:n,json:!0,fn:function(){return n}});n+=s}this.index++}this.throwError("Unterminated quote",t)}};var w=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n};w.ZERO=function(){return 0},w.prototype={constructor:w,parse:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t.literal=!!t.literal,t.constant=!!t.constant,t},primary:function(){var e;if(this.expect("("))e=this.filterChain(),this.consume(")");else if(this.expect("["))e=this.arrayDeclaration();else if(this.expect("{"))e=this.object();else{var t=this.expect();e=t.fn,e||this.throwError("not a primary expression",t),t.json&&(e.constant=!0,e.literal=!0)}for(var n,i;n=this.expect("(","[",".");)"("===n.text?(e=this.functionCall(e,i),i=null):"["===n.text?(i=e,e=this.objectIndex(e)):"."===n.text?(i=e,e=this.fieldAccess(e)):this.throwError("IMPOSSIBLE");return e},throwError:function(e,t){throw a("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},peekToken:function(){if(0===this.tokens.length)throw a("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,i){if(this.tokens.length>0){var r=this.tokens[0],s=r.text;if(s===e||s===t||s===n||s===i||!e&&!t&&!n&&!i)return r}return!1},expect:function(e,t,n,i){var r=this.peek(e,t,n,i);return r?(this.tokens.shift(),r):!1},consume:function(e){this.expect(e)||this.throwError("is unexpected, expecting ["+e+"]",this.peek())},unaryFn:function(e,t){return r(function(n,i){return e(n,i,t)},{constant:t.constant})},ternaryFn:function(e,t,n){return r(function(i,r){return e(i,r)?t(i,r):n(i,r)},{constant:e.constant&&t.constant&&n.constant})},binaryFn:function(e,t,n){return r(function(i,r){return t(i,r,e,n)},{constant:e.constant&&n.constant})},statements:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.filterChain()),!this.expect(";"))return 1===e.length?e[0]:function(t,n){for(var i,r=0;r<e.length;r++){var s=e[r];s&&(i=s(t,n))}return i}},filterChain:function(){for(var e,t=this.expression();;){if(!(e=this.expect("|")))return t;t=this.binaryFn(t,e.fn,this.filter())}},filter:function(){for(var e=this.expect(),t=this.$filter(e.text),n=[];;){if(!(e=this.expect(":"))){var i=function(e,i,r){for(var s=[r],o=0;o<n.length;o++)s.push(n[o](e,i));return t.apply(e,s)};return function(){return i}}n.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var e,t,n=this.ternary();return(t=this.expect("="))?(n.assign||this.throwError("implies assignment but ["+this.text.substring(0,t.index)+"] can not be assigned to",t),e=this.ternary(),function(t,i){return n.assign(t,e(t,i),i)}):n},ternary:function(){var e,t,n=this.logicalOR();return(t=this.expect("?"))?(e=this.ternary(),(t=this.expect(":"))?this.ternaryFn(n,e,this.ternary()):void this.throwError("expected :",t)):n},logicalOR:function(){for(var e,t=this.logicalAND();;){if(!(e=this.expect("||")))return t;t=this.binaryFn(t,e.fn,this.logicalAND())}},logicalAND:function(){var e,t=this.equality();return(e=this.expect("&&"))&&(t=this.binaryFn(t,e.fn,this.logicalAND())),t},equality:function(){var e,t=this.relational();return(e=this.expect("==","!=","===","!=="))&&(t=this.binaryFn(t,e.fn,this.equality())),t},relational:function(){var e,t=this.additive();return(e=this.expect("<",">","<=",">="))&&(t=this.binaryFn(t,e.fn,this.relational())),t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t=this.binaryFn(t,e.fn,this.multiplicative());return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t=this.binaryFn(t,e.fn,this.unary());return t},unary:function(){var e;return this.expect("+")?this.primary():(e=this.expect("-"))?this.binaryFn(w.ZERO,e.fn,this.unary()):(e=this.expect("!"))?this.unaryFn(e.fn,this.unary()):this.primary()},fieldAccess:function(e){var t=this,n=this.expect().text,i=g(n,this.options,this.text);return r(function(t,n,r){return i(r||e(t,n))},{assign:function(i,r,s){return d(e(i,s),n,r,t.text,t.options)}})},objectIndex:function(e){var t=this,n=this.expression();return this.consume("]"),r(function(i,r){var s,o=e(i,r),a=n(i,r);return o?s=h(o[a],t.text):void 0},{assign:function(i,r,s){var o=n(i,s),a=h(e(i,s),t.text);return a[o]=r}})},functionCall:function(e,t){var n=[];if(")"!==this.peekToken().text)do n.push(this.expression());while(this.expect(","));this.consume(")");var r=this;return function(s,o){for(var a=[],l=t?t(s,o):s,c=0;c<n.length;c++)a.push(n[c](s,o));var u=e(s,o,l)||i;h(l,r.text),h(u,r.text);var d=u.apply?u.apply(l,a):u(a[0],a[1],a[2],a[3],a[4]);return h(d,r.text)}},arrayDeclaration:function(){var e=[],t=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var n=this.expression();e.push(n),n.constant||(t=!1)}while(this.expect(","));return this.consume("]"),r(function(t,n){for(var i=[],r=0;r<e.length;r++)i.push(e[r](t,n));return i},{literal:!0,constant:t})},object:function(){var e=[],t=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var n=this.expect(),i=n.string||n.text;this.consume(":");var s=this.expression();e.push({key:i,value:s}),s.constant||(t=!1)}while(this.expect(","));return this.consume("}"),r(function(t,n){for(var i={},r=0;r<e.length;r++){var s=e[r];i[s.key]=s.value(t,n)}return i},{literal:!0,constant:t})}};var k={};n.Lexer=b,n.Parser=w},{}],40:[function(e,t){function n(e,t){if("function"!=typeof t)throw new Error("Bad callback given: "+t);if(!e)throw new Error("No options given");var o=e.onResponse;if(e="string"==typeof e?{uri:e}:JSON.parse(JSON.stringify(e)),e.onResponse=o,e.verbose&&(n.log=s()),e.url&&(e.uri=e.url,delete e.url),!e.uri&&""!==e.uri)throw new Error("options.uri is a required argument");if("string"!=typeof e.uri)throw new Error("options.uri must be a string");for(var a=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<a.length;c++)if(e[a[c]])throw new Error("options."+a[c]+" is not supported");if(e.callback=t,e.method=e.method||"GET",e.headers=e.headers||{},e.body=e.body||null,e.timeout=e.timeout||n.DEFAULT_TIMEOUT,e.headers.host)throw new Error("Options.headers.host is not supported");e.json&&(e.headers.accept=e.headers.accept||"application/json","GET"!==e.method&&(e.headers["content-type"]="application/json"),"boolean"!=typeof e.json?e.body=JSON.stringify(e.json):"string"!=typeof e.body&&(e.body=JSON.stringify(e.body)));var u=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};if(e.qs){var h="string"==typeof e.qs?e.qs:u(e.qs);e.uri=-1!==e.uri.indexOf("?")?e.uri+"&"+h:e.uri+"?"+h}var d=function(e){var t={};t.boundry="-------------------------------"+Math.floor(1e9*Math.random());var n=[];for(var i in e)e.hasOwnProperty(i)&&n.push("--"+t.boundry+'\nContent-Disposition: form-data; name="'+i+'"\n\n'+e[i]+"\n");return n.push("--"+t.boundry+"--"),t.body=n.join(""),t.length=t.body.length,t.type="multipart/form-data; boundary="+t.boundry,t};if(e.form){if("string"==typeof e.form)throw"form name unsupported";if("POST"===e.method){var p=(e.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(e.headers["content-type"]=p,p){case"application/x-www-form-urlencoded":e.body=u(e.form).replace(/%20/g,"+");break;case"multipart/form-data":var f=d(e.form);e.body=f.body,e.headers["content-type"]=f.type;break;default:throw new Error("unsupported encoding:"+p)}}}return e.onResponse=e.onResponse||r,e.onResponse===!0&&(e.onResponse=t,e.callback=r),!e.headers.authorization&&e.auth&&(e.headers.authorization="Basic "+l(e.auth.username+":"+e.auth.password)),i(e)}function i(e){function t(){u=!0;var t=new Error("ETIMEDOUT");return t.code="ETIMEDOUT",t.duration=e.timeout,n.log.error("Timeout",{id:l._id,milliseconds:e.timeout}),e.callback(t,l)}function i(){if(u)return n.log.debug("Ignoring timed out state change",{state:l.readyState,id:l.id});if(n.log.debug("State change",{state:l.readyState,id:l.id,timed_out:u}),l.readyState===c.OPENED){n.log.debug("Request started",{id:l.id});for(var t in e.headers)l.setRequestHeader(t,e.headers[t])}else l.readyState===c.HEADERS_RECEIVED?r():l.readyState===c.LOADING?(r(),s()):l.readyState===c.DONE&&(r(),s(),o())}function r(){if(!m.response){if(m.response=!0,n.log.debug("Got response",{id:l.id,status:l.status}),clearTimeout(l.timeoutTimer),l.statusCode=l.status,d&&0==l.statusCode){var t=new Error("CORS request rejected: "+e.uri);return t.cors="rejected",m.loading=!0,m.end=!0,e.callback(t,l)}e.onResponse(null,l)}}function s(){m.loading||(m.loading=!0,n.log.debug("Response body loading",{id:l.id}))}function o(){if(!m.end){if(m.end=!0,n.log.debug("Request done",{id:l.id}),l.body=l.responseText,e.json)try{l.body=JSON.parse(l.responseText)}catch(t){return e.callback(t,l)}e.callback(null,l,l.body)}}var l=new c,u=!1,d=a(e.uri),p="withCredentials"in l;if(h+=1,l.seq_id=h,l.id=h+": "+e.method+" "+e.uri,l._id=l.id,d&&!p){var f=new Error("Browser does not support cross-origin request: "+e.uri);return f.cors="unsupported",e.callback(f,l)}l.timeoutTimer=setTimeout(t,e.timeout);var m={response:!1,loading:!1,end:!1};return l.onreadystatechange=i,l.open(e.method,e.uri,!0),d&&(l.withCredentials=!!e.withCredentials),l.send(e.body),l}function r(){}function s(){var e,t,n={},i=["trace","debug","info","warn","error"];for(t=0;t<i.length;t++)e=i[t],n[e]=r,"undefined"!=typeof console&&console&&console[e]&&(n[e]=o(console,e));return n}function o(e,t){function n(n,i){return"object"==typeof i&&(n+=" "+JSON.stringify(i)),e[t].call(e,n)}return n}function a(e){var t,n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{t=location.href}catch(i){t=document.createElement("a"),t.href="",t=t.href}var r=n.exec(t.toLowerCase())||[],s=n.exec(e.toLowerCase()),o=!(!s||s[1]==r[1]&&s[2]==r[2]&&(s[3]||("http:"===s[1]?80:443))==(r[3]||("http:"===r[1]?80:443)));return o}function l(e){var t,n,i,r,s,o,a,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,h=0,d="",p=[];if(!e)return e;do t=e.charCodeAt(u++),n=e.charCodeAt(u++),i=e.charCodeAt(u++),l=t<<16|n<<8|i,r=l>>18&63,s=l>>12&63,o=l>>6&63,a=63&l,p[h++]=c.charAt(r)+c.charAt(s)+c.charAt(o)+c.charAt(a);while(u<e.length);switch(d=p.join(""),e.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d}var c=XMLHttpRequest;if(!c)throw new Error("missing XMLHttpRequest");n.log={trace:r,debug:r,info:r,warn:r,error:r};var u=18e4,h=0;n.withCredentials=!1,n.DEFAULT_TIMEOUT=u,n.defaults=function(e){var t=function(t){var n=function(n,i){n="string"==typeof n?{uri:n}:JSON.parse(JSON.stringify(n));for(var r in e)void 0===n[r]&&(n[r]=e[r]);return t(n,i)};return n},i=t(n);return i.get=t(n.get),i.post=t(n.post),i.put=t(n.put),i.head=t(n.head),i};var d=["get","put","post","head"];d.forEach(function(e){var t=e.toUpperCase(),i=e.toLowerCase();n[i]=function(e){"string"==typeof e?e={method:t,uri:e}:(e=JSON.parse(JSON.stringify(e)),e.method=t);var i=[e].concat(Array.prototype.slice.apply(arguments,[1]));return n.apply(this,i)}}),n.couch=function(e,t){function i(e,n,i){if(e)return t(e,n,i);if((n.statusCode<200||n.statusCode>299)&&i.error){e=new Error("CouchDB error: "+(i.error.reason||i.error.error));for(var r in i)e[r]=i[r];return t(e,n,i)}return t(e,n,i)}"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,t=t||r;var s=n(e,i);return s},t.exports=n},{}],41:[function(e,t){!function(){var e={serialize:function(e,t,i){i=i||{};var r=i.encode||n,s=[e+"="+r(t)];if(null!=i.maxAge){var o=i.maxAge-0;if(isNaN(o))throw new Error("maxAge should be a Number");s.push("Max-Age="+o)}return i.domain&&s.push("Domain="+i.domain),i.path&&s.push("Path="+i.path),i.expires&&s.push("Expires="+i.expires.toUTCString()),i.httpOnly&&s.push("HttpOnly"),i.secure&&s.push("Secure"),s.join("; ")},parse:function(e,t){t=t||{};var n={},r=e.split(/; */),s=t.decode||i;return r.forEach(function(e){var t=e.indexOf("=");if(!(0>t)){var i=e.substr(0,t).trim(),r=e.substr(++t,e.length).trim();if('"'==r[0]&&(r=r.slice(1,-1)),void 0==n[i])try{n[i]=s(r)}catch(o){n[i]=r}}}),n}},n=encodeURIComponent,i=decodeURIComponent;"undefined"!=typeof t&&t.exports?t.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.cookiejs=e}()},{}],42:[function(e,t){!function(){var e={};!function(){function t(e,n,i){var r=function(){};r.prototype=e.prototype;var s=new r,o=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/;i=i||{};for(var a in i){var l=i[a],c=s[a];s[a]="function"==typeof c&&"function"==typeof l&&o.test(l)?function(e,t){return function(){var n=this.parent;this.parent=t;var i=e.apply(this,arguments);return this.parent=n,i}}(l,c):l}s.typename=n;var u=function(){s.init&&s.init.apply(this,arguments)};return u.prototype=s,u.prototype.constructor=u,u.extend=function(e,n){return"object"==typeof e&&(n=e,e="anonymous"),t(u,e,n)},u}e.object=t(Object,"Object",{})}(),function(){var t=Array.prototype,n=Object.prototype,i={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},r=/[&"'<>]/g,s=function(e){return i[e]},o=e.lib={};o.withPrettyErrors=function(e,t,n){try{return n()}catch(i){if(i.Update||(i=new o.TemplateError(i)),i.Update(e),!t){var r=i;i=new Error(r.message),i.name=r.name}throw i}},o.TemplateError=function(e,t,n){var i=this;return e instanceof Error?(i=e,e=e.name+": "+e.message):Error.captureStackTrace&&Error.captureStackTrace(i),i.name="Template render error",i.message=e,i.lineno=t,i.colno=n,i.firstUpdate=!0,i.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},i},o.TemplateError.prototype=Error.prototype,o.escape=function(e){return e.replace(r,s)},o.isFunction=function(e){return"[object Function]"==n.toString.call(e)},o.isArray=Array.isArray||function(e){return"[object Array]"==n.toString.call(e)},o.isString=function(e){return"[object String]"==n.toString.call(e)},o.isObject=function(e){return"[object Object]"==n.toString.call(e)},o.groupBy=function(e,t){for(var n={},i=o.isFunction(t)?t:function(e){return e[t]},r=0;r<e.length;r++){var s=e[r],a=i(s,r);(n[a]||(n[a]=[])).push(s)}return n},o.toArray=function(e){return Array.prototype.slice.call(e)},o.without=function(e){var t=[];if(!e)return t;for(var n=-1,i=e.length,r=o.toArray(arguments).slice(1);++n<i;)-1===r.indexOf(e[n])&&t.push(e[n]);return t},o.extend=function(e,t){for(var n in t)e[n]=t[n];return e},o.repeat=function(e,t){for(var n="",i=0;t>i;i++)n+=e;return n},o.each=function(e,n,i){if(null!=e)if(t.each&&e.each==t.each)e.forEach(n,i);else if(e.length===+e.length)for(var r=0,s=e.length;s>r;r++)n.call(i,e[r],r,e)},o.map=function(e,n){var i=[];if(null==e)return i;if(t.map&&e.map===t.map)return e.map(n);for(var r=0;r<e.length;r++)i[i.length]=n(e[r],r);return e.length===+e.length&&(i.length=e.length),i},o.asyncIter=function(e,t,n){function i(){r++,r<e.length?t(e[r],r,i,n):n()}var r=-1;i()},o.asyncFor=function(e,t,n){function i(){a++;var o=r[a];s>a?t(o,e[o],a,s,i):n()}var r=o.keys(e),s=r.length,a=-1;i()},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(null==e)throw new TypeError;var n=Object(e),i=n.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>2&&(r=Number(arguments[2]),r!=r?r=0:0!=r&&1/0!=r&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var s=r>=0?r:Math.max(i-Math.abs(r),0);i>s;s++)if(s in n&&n[s]===t)return s;return-1}),Array.prototype.map||(Array.prototype.map=function(){throw new Error("map is unimplemented for this js engine")}),o.keys=function(e){if(Object.prototype.keys)return e.keys();var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}}(),function(){function t(e,t,n){e instanceof t&&n.push(e),e instanceof o&&e.findAll(t,n)}function n(e,t){function s(e,t,n){for(var r=e.split("\n"),s=0;s<r.length;s++){if(r[s]&&(n&&s>0||!n))for(var o=0;t>o;o++)i.print(" ");s===r.length-1?i.print(r[s]):i.puts(r[s])}}if(t=t||0,s(e.typename+": ",t),e instanceof l)s("\n"),r.each(e.children,function(e){n(e,t+2)});else if(e instanceof et)s(e.extName+"."+e.prop),s("\n"),e.args&&n(e.args,t+2),e.contentArgs&&r.each(e.contentArgs,function(e){n(e,t+2)});else{var a=null,c=null;if(e.iterFields(function(e,t){e instanceof o?(a=a||{},a[t]=e):(c=c||{},c[t]=e)}),c?s(i.inspect(c,!0,null)+"\n",null,!0):s("\n"),a)for(var u in a)n(a[u],t+2)}}var i=e.util,r=e.lib,s=e.object,o=s.extend("Node",{init:function(e,t){this.lineno=e,this.colno=t;for(var n=this.fields,i=0,r=n.length;r>i;i++){var s=n[i],o=arguments[i+2];void 0===o&&(o=null),this[s]=o}},findAll:function(e,n){if(n=n||[],this instanceof l)for(var i=this.children,r=0,s=i.length;s>r;r++)t(i[r],e,n);else for(var o=this.fields,r=0,s=o.length;s>r;r++)t(this[o[r]],e,n);return n},iterFields:function(e){r.each(this.fields,function(t){e(this[t],t)},this)}}),a=o.extend("Value",{fields:["value"]}),l=o.extend("NodeList",{fields:["children"],init:function(e,t,n){this.parent(e,t,n||[])},addChild:function(e){this.children.push(e)}}),c=l.extend("Root"),u=a.extend("Literal"),h=a.extend("Symbol"),d=l.extend("Group"),p=l.extend("Array"),f=o.extend("Pair",{fields:["key","value"]}),m=l.extend("Dict"),g=o.extend("LookupVal",{fields:["target","val"]}),v=o.extend("If",{fields:["cond","body","else_"]}),y=v.extend("IfAsync"),b=o.extend("InlineIf",{fields:["cond","body","else_"]}),w=o.extend("For",{fields:["arr","name","body"]}),k=w.extend("AsyncEach"),x=w.extend("AsyncAll"),E=o.extend("Macro",{fields:["name","args","body"]}),T=o.extend("Import",{fields:["template","target"]}),A=o.extend("FromImport",{fields:["template","names"],init:function(e,t,n,i){this.parent(e,t,n,i||new l)}}),S=o.extend("FunCall",{fields:["name","args"]}),L=S.extend("Filter"),C=L.extend("FilterAsync",{fields:["name","args","symbol"]}),O=m.extend("KeywordArgs"),_=o.extend("Block",{fields:["name","body"]}),R=o.extend("Super",{fields:["blockName","symbol"]}),N=o.extend("TemplateRef",{fields:["template"]}),M=N.extend("Extends"),F=N.extend("Include"),P=o.extend("Set",{fields:["targets","value"]}),j=l.extend("Output"),D=u.extend("TemplateData"),I=o.extend("UnaryOp",{fields:["target"]}),U=o.extend("BinOp",{fields:["left","right"]}),q=U.extend("Or"),K=U.extend("And"),B=I.extend("Not"),G=U.extend("Add"),$=U.extend("Sub"),V=U.extend("Mul"),W=U.extend("Div"),H=U.extend("FloorDiv"),z=U.extend("Mod"),X=U.extend("Pow"),Y=I.extend("Neg"),Z=I.extend("Pos"),J=o.extend("Compare",{fields:["expr","ops"]}),Q=o.extend("CompareOperand",{fields:["expr","type"]}),et=(o.extend("CustomTag",{init:function(e,t,n){this.lineno=e,this.colno=t,this.name=n}}),o.extend("CallExtension",{fields:["extName","prop","args","contentArgs"],init:function(e,t,n,i){this.extName=e._name||e,this.prop=t,this.args=n||new l,this.contentArgs=i||[],this.autoescape=e.autoescape}})),tt=et.extend("CallExtensionAsync");e.nodes={Node:o,Root:c,NodeList:l,Value:a,Literal:u,Symbol:h,Group:d,Array:p,Pair:f,Dict:m,Output:j,TemplateData:D,If:v,IfAsync:y,InlineIf:b,For:w,AsyncEach:k,AsyncAll:x,Macro:E,Import:T,FromImport:A,FunCall:S,Filter:L,FilterAsync:C,KeywordArgs:O,Block:_,Super:R,Extends:M,Include:F,Set:P,LookupVal:g,BinOp:U,Or:q,And:K,Not:B,Add:G,Sub:$,Mul:V,Div:W,FloorDiv:H,Mod:z,Pow:X,Neg:Y,Pos:Z,Compare:J,CompareOperand:Q,CallExtension:et,CallExtensionAsync:tt,printNodes:n}}(),function(){function t(e,t,n){return function(){var s,o=r(arguments),a=i(arguments);if(o>e.length){s=Array.prototype.slice.call(arguments,0,e.length);for(var l=Array.prototype.slice.call(arguments,s.length,o),c=0;c<l.length;c++)c<t.length&&(a[t[c]]=l[c]);s.push(a)}else if(o<e.length){s=Array.prototype.slice.call(arguments,0,o);for(var c=o;c<e.length;c++){var u=e[c];s.push(a[u]),delete a[u]}s.push(a)}else s=arguments;return n.apply(this,s)}}function n(e){return e.__keywords=!0,e}function i(e){var t=e.length;if(t){var n=e[t-1];if(n&&n.hasOwnProperty("__keywords"))return n}return{}}function r(e){var t=e.length;if(0===t)return 0;var n=e[t-1];return n&&n.hasOwnProperty("__keywords")?t-1:t}function s(e){return"string"!=typeof e?e:void(this.val=e)}function o(e,t){return e instanceof s?new s(t):t.toString()}function a(e){var t=typeof e;return"string"===t?new s(e):"function"!==t?e:function(){var t=e.apply(this,arguments);return"string"==typeof t?new s(t):t}}function l(e,t){return e=void 0!==e&&null!==e?e:"",t&&"string"==typeof e&&(e=m.escape(e)),e}function c(e,t){return e=e||{},"function"==typeof e[t]?function(){return e[t].apply(e,arguments)}:e[t]}function u(e,t,n){if(!e)throw new Error("Unable to call `"+t+"`, which is undefined or falsey");if("function"!=typeof e)throw new Error("Unable to call `"+t+"`, which is not a function");return e.apply(this,n)}function h(e,t,n){var i=t.lookup(n);return void 0!==i&&null!==i?i:e.lookup(n)}function d(e,t,n){return e.lineno?e:new m.TemplateError(e,t,n)}function p(e,t,n,i){if(m.isArray(e)){var r=e.length;m.asyncIter(e,function(e,i,s){switch(t){case 1:n(e,i,r,s);break;case 2:n(e[0],e[1],i,r,s);break;case 3:n(e[0],e[1],e[2],i,r,s);break;default:e.push(i,s),n.apply(this,e)}},i)}else m.asyncFor(e,function(e,t,i,r,s){n(e,t,i,r,s)},i)}function f(e,t,n,i){function r(e,t){a++,o[e]=t,a==s&&i(null,o.join(""))}var s,o,a=0;if(m.isArray(e))if(s=e.length,o=new Array(s),0==s)i(null,"");else for(var l=0;l<e.length;l++){var c=e[l];switch(t){case 1:n(c,l,s,r);break;case 2:n(c[0],c[1],l,s,r);break;case 3:n(c[0],c[1],c[2],l,s,r);break;default:c.push(l,r),n.apply(this,c)}}else{var u=m.keys(e);if(s=u.length,o=new Array(s),0==s)i(null,"");else for(var l=0;l<u.length;l++){var h=u[l];n(h,e[h],l,s,r)}}}var m=e.lib,g=e.object,v=g.extend({init:function(e){this.variables={},this.parent=e},set:function(e,t,n){var i=e.split("."),r=this.variables,s=this;if(n){if(s=this.resolve(i[0]))return void s.set(e,t);s=this}for(var o=0;o<i.length-1;o++){var a=i[o];r[a]||(r[a]={}),r=r[a]}r[i[i.length-1]]=t},get:function(e){var t=this.variables[e];return void 0!==t&&null!==t?t:null},lookup:function(e){var t=this.parent,n=this.variables[e];return void 0!==n&&null!==n?n:t&&t.lookup(e)},resolve:function(e){var t=this.parent,n=this.variables[e];return null!=n?this:t&&t.resolve(e)},push:function(){return new v(this)},pop:function(){return this.parent}});s.prototype=Object.create(String.prototype),s.prototype.valueOf=function(){return this.val},s.prototype.toString=function(){return this.val},e.runtime={Frame:v,makeMacro:t,makeKeywordArgs:n,numArgs:r,suppressValue:l,memberLookup:c,contextOrFrameLookup:h,callWrap:u,handleError:d,isArray:m.isArray,keys:m.keys,SafeString:s,copySafeness:o,markSafe:a,asyncEach:p,asyncAll:f}}(),function(){function t(e,t,n,i){return{type:e,value:t,lineno:n,colno:i}}function n(e){this.str=e,this.index=0,this.len=e.length,this.lineno=0,this.colno=0,this.in_code=!1}var i=(e.lib," \n	\r"),r="()[]{}%*-+/#,:|.<>=!",s="0123456789",o="{%",a="%}",l="{{",c="}}",u="{#",h="#}",d="string",p="whitespace",f="data",m="block-start",g="block-end",v="variable-start",y="variable-end",b="comment",w="left-paren",k="right-paren",x="left-bracket",E="right-bracket",T="left-curly",A="right-curly",S="operator",L="comma",C="colon",O="pipe",_="int",R="float",N="boolean",M="symbol",F="special";n.prototype.nextToken=function(){var e=this.lineno,n=this.colno;if(this.in_code){var F,P=this.current();if(this.is_finished())return null;if('"'==P||"'"==P)return t(d,this.parseString(P),e,n);if(F=this._extract(i))return t(p,F,e,n);if((F=this._extractString(a))||(F=this._extractString("-"+a)))return this.in_code=!1,t(g,F,e,n);if(F=this._extractString(c))return this.in_code=!1,t(y,F,e,n);if(-1!=r.indexOf(P)){this.forward();var j,D=["==","!=","<=",">=","//","**"],I=P+this.current();switch(-1!==D.indexOf(I)&&(this.forward(),P=I),P){case"(":j=w;break;case")":j=k;break;case"[":j=x;break;case"]":j=E;break;case"{":j=T;break;case"}":j=A;break;case",":j=L;break;case":":j=C;break;case"|":j=O;break;default:j=S}return t(j,P,e,n)}if(F=this._extractUntil(i+r),F.match(/^[-+]?[0-9]+$/)){if("."==this.current()){this.forward();var U=this._extract(s);return t(R,F+"."+U,e,n)}return t(_,F,e,n)}if(F.match(/^(true|false)$/))return t(N,F,e,n);if(F)return t(M,F,e,n);throw new Error("Unexpected value while parsing: "+F)}var F,q=o.charAt(0)+l.charAt(0)+u.charAt(0)+h.charAt(0);if(this.is_finished())return null;if((F=this._extractString(o+"-"))||(F=this._extractString(o)))return this.in_code=!0,t(m,F,e,n);if(F=this._extractString(l))return this.in_code=!0,t(v,F,e,n);F="";var K,B=!1;for(this._matches(u)&&(B=!0,F=this._extractString(u));null!==(K=this._extractUntil(q))&&(F+=K,!(this._matches(o)||this._matches(l)||this._matches(u))||B);){if(this._matches(h)){if(!B)throw new Error("unexpected end of comment");F+=this._extractString(h);break}F+=this.current(),this.forward()}if(null===K&&B)throw new Error("expected end of comment, got end of file");return t(B?b:f,F,e,n)},n.prototype.parseString=function(e){this.forward();for(var t=(this.lineno,this.colno,"");!this.is_finished()&&this.current()!=e;){var n=this.current();if("\\"==n){switch(this.forward(),this.current()){case"n":t+="\n";break;case"t":t+="	";break;case"r":t+="\r";break;default:t+=this.current()}this.forward()}else t+=n,this.forward()}return this.forward(),t},n.prototype._matches=function(e){if(this.index+e.length>this.length)return null;var t=this.str.slice(this.index,this.index+e.length);return t==e},n.prototype._extractString=function(e){return this._matches(e)?(this.index+=e.length,e):null},n.prototype._extractUntil=function(e){return this._extractMatching(!0,e||"")},n.prototype._extract=function(e){return this._extractMatching(!1,e)},n.prototype._extractMatching=function(e,t){if(this.is_finished())return null;var n=t.indexOf(this.current());if(e&&-1==n||!e&&-1!=n){var i=this.current();this.forward();for(var r=t.indexOf(this.current());(e&&-1==r||!e&&-1!=r)&&!this.is_finished();)i+=this.current(),this.forward(),r=t.indexOf(this.current());return i}return""},n.prototype.is_finished=function(){return this.index>=this.len},n.prototype.forwardN=function(e){for(var t=0;e>t;t++)this.forward()},n.prototype.forward=function(){this.index++,"\n"==this.previous()?(this.lineno++,this.colno=0):this.colno++},n.prototype.back=function(){if(this.index--,"\n"==this.current()){this.lineno--;var e=this.src.lastIndexOf("\n",this.index-1);this.colno=-1==e?this.index:this.index-e}else this.colno--},n.prototype.current=function(){return this.is_finished()?"":this.str.charAt(this.index)},n.prototype.previous=function(){return this.str.charAt(this.index-1)},e.lexer={lex:function(e){return new n(e)},setTags:function(e){o=e.blockStart||o,a=e.blockEnd||a,l=e.variableStart||l,c=e.variableEnd||c,u=e.commentStart||u,h=e.commentEnd||h},TOKEN_STRING:d,TOKEN_WHITESPACE:p,TOKEN_DATA:f,TOKEN_BLOCK_START:m,TOKEN_BLOCK_END:g,TOKEN_VARIABLE_START:v,TOKEN_VARIABLE_END:y,TOKEN_COMMENT:b,TOKEN_LEFT_PAREN:w,TOKEN_RIGHT_PAREN:k,TOKEN_LEFT_BRACKET:x,TOKEN_RIGHT_BRACKET:E,TOKEN_LEFT_CURLY:T,TOKEN_RIGHT_CURLY:A,TOKEN_OPERATOR:S,TOKEN_COMMA:L,TOKEN_COLON:C,TOKEN_PIPE:O,TOKEN_INT:_,TOKEN_FLOAT:R,TOKEN_BOOLEAN:N,TOKEN_SYMBOL:M,TOKEN_SPECIAL:F}}(),function(){var t=e.lexer,n=e.nodes,i=e.object,r=e.lib,s=i.extend({init:function(e){this.tokens=e,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},nextToken:function(e){var n;if(this.peeked){if(e||this.peeked.type!=t.TOKEN_WHITESPACE)return n=this.peeked,this.peeked=null,n;this.peeked=null}if(n=this.tokens.nextToken(),!e)for(;n&&n.type==t.TOKEN_WHITESPACE;)n=this.tokens.nextToken();return n},peekToken:function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},pushToken:function(e){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=e},fail:function(e,t,n){if((void 0===t||void 0===n)&&this.peekToken()){var i=this.peekToken();t=i.lineno,n=i.colno}throw void 0!==t&&(t+=1),void 0!==n&&(n+=1),new r.TemplateError(e,t,n)},skip:function(e){var t=this.nextToken();return t&&t.type==e?!0:(this.pushToken(t),!1)},expect:function(e){var t=this.nextToken();return t.type!==e&&this.fail("expected "+e+", got "+t.type,t.lineno,t.colno),t},skipValue:function(e,t){var n=this.nextToken();return n&&n.type==e&&n.value==t?!0:(this.pushToken(n),!1)},skipWhitespace:function(){return this.skip(t.TOKEN_WHITESPACE)},skipSymbol:function(e){return this.skipValue(t.TOKEN_SYMBOL,e)},advanceAfterBlockEnd:function(e){if(!e){var n=this.peekToken();n||this.fail("unexpected end of file"),n.type!=t.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),e=this.nextToken().value}var n=this.nextToken();n&&n.type==t.TOKEN_BLOCK_END?"-"===n.value.charAt(0)&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+e+" statement")},advanceAfterVariableEnd:function(){this.skip(t.TOKEN_VARIABLE_END)||this.fail("expected variable end")},parseFor:function(){var e,i,r=this.peekToken();this.skipSymbol("for")?(e=new n.For(r.lineno,r.colno),i="endfor"):this.skipSymbol("asyncEach")?(e=new n.AsyncEach(r.lineno,r.colno),i="endeach"):this.skipSymbol("asyncAll")?(e=new n.AsyncAll(r.lineno,r.colno),i="endall"):this.fail("parseFor: expected for{Async}",r.lineno,r.colno),e.name=this.parsePrimary(),e.name instanceof n.Symbol||this.fail("parseFor: variable name expected for loop");var s=this.peekToken().type;if(s==t.TOKEN_COMMA){var o=e.name;for(e.name=new n.Array(o.lineno,o.colno),e.name.addChild(o);this.skip(t.TOKEN_COMMA);){var a=this.parsePrimary();
e.name.addChild(a)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',r.lineno,r.colno),e.arr=this.parseExpression(),this.advanceAfterBlockEnd(r.value),e.body=this.parseUntilBlocks(i),this.advanceAfterBlockEnd(),e},parseMacro:function(){var e=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var t=this.parsePrimary(!0),i=this.parseSignature(),r=new n.Macro(e.lineno,e.colno,t,i);return this.advanceAfterBlockEnd(e.value),r.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),r},parseImport:function(){var e=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",e.lineno,e.colno);var t=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',e.lineno,e.colno);var i=this.parsePrimary(),r=new n.Import(e.lineno,e.colno,t,i);return this.advanceAfterBlockEnd(e.value),r},parseFrom:function(){var e=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var i=this.parsePrimary(),r=new n.FromImport(e.lineno,e.colno,i,new n.NodeList);this.skipSymbol("import")||this.fail("parseFrom: expected import",e.lineno,e.colno);for(var s=r.names;;){var o=this.peekToken();if(o.type==t.TOKEN_BLOCK_END){s.children.length||this.fail("parseFrom: Expected at least one import name",e.lineno,e.colno),"-"==o.value.charAt(0)&&(this.dropLeadingWhitespace=!0),this.nextToken();break}s.children.length>0&&!this.skip(t.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",e.lineno,e.colno);var a=this.parsePrimary();if("_"==a.value.charAt(0)&&this.fail("parseFrom: names starting with an underscore cannot be imported",a.lineno,a.colno),this.skipSymbol("as")){var l=this.parsePrimary();s.addChild(new n.Pair(a.lineno,a.colno,a,l))}else s.addChild(a)}return r},parseBlock:function(){var e=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",e.lineno,e.colno);var t=new n.Block(e.lineno,e.colno);return t.name=this.parsePrimary(),t.name instanceof n.Symbol||this.fail("parseBlock: variable name expected",e.lineno,e.colno),this.advanceAfterBlockEnd(e.value),t.body=this.parseUntilBlocks("endblock"),this.peekToken()||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(),t},parseTemplateRef:function(e,t){var n=this.peekToken();this.skipSymbol(e)||this.fail("parseTemplateRef: expected "+e);var i=new t(n.lineno,n.colno);return i.template=this.parseExpression(),this.advanceAfterBlockEnd(n.value),i},parseExtends:function(){return this.parseTemplateRef("extends",n.Extends)},parseInclude:function(){return this.parseTemplateRef("include",n.Include)},parseIf:function(){var e,t=this.peekToken();this.skipSymbol("if")||this.skipSymbol("elif")?e=new n.If(t.lineno,t.colno):this.skipSymbol("ifAsync")?e=new n.IfAsync(t.lineno,t.colno):this.fail("parseIf: expected if or elif",t.lineno,t.colno),e.cond=this.parseExpression(),this.advanceAfterBlockEnd(t.value),e.body=this.parseUntilBlocks("elif","else","endif");var i=this.peekToken();switch(i&&i.value){case"elif":e.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),e.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":e.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected endif, else, or endif, got end of file")}return e},parseSet:function(){var e=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",e.lineno,e.colno);for(var i,r=new n.Set(e.lineno,e.colno,[]);(i=this.parsePrimary())&&(r.targets.push(i),this.skip(t.TOKEN_COMMA)););return this.skipValue(t.TOKEN_OPERATOR,"=")||this.fail("parseSet: expected = in set tag",e.lineno,e.colno),r.value=this.parseExpression(),this.advanceAfterBlockEnd(e.value),r},parseStatement:function(){var e,i=this.peekToken();if(i.type!=t.TOKEN_SYMBOL&&this.fail("tag name expected",i.lineno,i.colno),this.breakOnBlocks&&-1!==this.breakOnBlocks.indexOf(i.value))return null;switch(i.value){case"raw":return this.parseRaw();case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"import":return this.parseImport();case"from":return this.parseFrom();default:if(this.extensions.length)for(var r=0;r<this.extensions.length;r++){var s=this.extensions[r];if(-1!==(s.tags||[]).indexOf(i.value))return s.parse(this,n,t)}this.fail("unknown block tag: "+i.value,i.lineno,i.colno)}return e},parseRaw:function(){this.advanceAfterBlockEnd();for(var e="",i=this.peekToken();;){var r=this.nextToken(!0);if(r||this.fail("expected endraw, got end of file"),r.type==t.TOKEN_BLOCK_START){var s=null,o=this.nextToken(!0);if(o.type==t.TOKEN_WHITESPACE&&(s=o,o=this.nextToken()),o.type==t.TOKEN_SYMBOL&&"endraw"==o.value){this.advanceAfterBlockEnd(o.value);break}e+=r.value,s&&(e+=s.value),e+=o.value}else e+=r.type===t.TOKEN_STRING?'"'+r.value+'"':r.value}var a=new n.Output(i.lineno,i.colno,[new n.TemplateData(i.lineno,i.colno,e)]);return a},parsePostfix:function(e){for(var i=this.peekToken();i;){if(i.type==t.TOKEN_LEFT_PAREN)e=new n.FunCall(i.lineno,i.colno,e,this.parseSignature());else if(i.type==t.TOKEN_LEFT_BRACKET){var r=this.parseAggregate();r.children.length>1&&this.fail("invalid index"),e=new n.LookupVal(i.lineno,i.colno,e,r.children[0])}else{if(i.type!=t.TOKEN_OPERATOR||"."!=i.value)break;this.nextToken();var s=this.nextToken();s.type!=t.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+s.value,s.lineno,s.colno);var r=new n.Literal(s.lineno,s.colno,s.value);e=new n.LookupVal(i.lineno,i.colno,e,r)}i=this.peekToken()}return e},parseExpression:function(){var e=this.parseInlineIf();return e},parseInlineIf:function(){var e=this.parseOr();if(this.skipSymbol("if")){var t=this.parseOr(),i=e;e=new n.InlineIf(e.lineno,e.colno),e.body=i,e.cond=t,e.else_=this.skipSymbol("else")?this.parseOr():null}return e},parseOr:function(){for(var e=this.parseAnd();this.skipSymbol("or");){var t=this.parseAnd();e=new n.Or(e.lineno,e.colno,e,t)}return e},parseAnd:function(){for(var e=this.parseNot();this.skipSymbol("and");){var t=this.parseNot();e=new n.And(e.lineno,e.colno,e,t)}return e},parseNot:function(){var e=this.peekToken();return this.skipSymbol("not")?new n.Not(e.lineno,e.colno,this.parseNot()):this.parseCompare()},parseCompare:function(){for(var e=["==","!=","<",">","<=",">="],i=this.parseAdd(),r=[];;){var s=this.nextToken();if(!s)break;if(-1!==e.indexOf(s.value))r.push(new n.CompareOperand(s.lineno,s.colno,this.parseAdd(),s.value));else if(s.type==t.TOKEN_SYMBOL&&"in"==s.value)r.push(new n.CompareOperand(s.lineno,s.colno,this.parseAdd(),"in"));else{if(s.type!=t.TOKEN_SYMBOL||"not"!=s.value||!this.skipSymbol("in")){this.pushToken(s);break}r.push(new n.CompareOperand(s.lineno,s.colno,this.parseAdd(),"notin"))}}return r.length?new n.Compare(r[0].lineno,r[0].colno,i,r):i},parseAdd:function(){for(var e=this.parseSub();this.skipValue(t.TOKEN_OPERATOR,"+");){var i=this.parseSub();e=new n.Add(e.lineno,e.colno,e,i)}return e},parseSub:function(){for(var e=this.parseMul();this.skipValue(t.TOKEN_OPERATOR,"-");){var i=this.parseMul();e=new n.Sub(e.lineno,e.colno,e,i)}return e},parseMul:function(){for(var e=this.parseDiv();this.skipValue(t.TOKEN_OPERATOR,"*");){var i=this.parseDiv();e=new n.Mul(e.lineno,e.colno,e,i)}return e},parseDiv:function(){for(var e=this.parseFloorDiv();this.skipValue(t.TOKEN_OPERATOR,"/");){var i=this.parseFloorDiv();e=new n.Div(e.lineno,e.colno,e,i)}return e},parseFloorDiv:function(){for(var e=this.parseMod();this.skipValue(t.TOKEN_OPERATOR,"//");){var i=this.parseMod();e=new n.FloorDiv(e.lineno,e.colno,e,i)}return e},parseMod:function(){for(var e=this.parsePow();this.skipValue(t.TOKEN_OPERATOR,"%");){var i=this.parsePow();e=new n.Mod(e.lineno,e.colno,e,i)}return e},parsePow:function(){for(var e=this.parseUnary();this.skipValue(t.TOKEN_OPERATOR,"**");){var i=this.parseUnary();e=new n.Pow(e.lineno,e.colno,e,i)}return e},parseUnary:function(e){var i,r=this.peekToken();return i=this.skipValue(t.TOKEN_OPERATOR,"-")?new n.Neg(r.lineno,r.colno,this.parseUnary(!0)):this.skipValue(t.TOKEN_OPERATOR,"+")?new n.Pos(r.lineno,r.colno,this.parseUnary(!0)):this.parsePrimary(),e||(i=this.parseFilter(i)),i},parsePrimary:function(e){var i=this.nextToken(),r=null,s=null;return i?i.type==t.TOKEN_STRING?r=i.value:i.type==t.TOKEN_INT?r=parseInt(i.value,10):i.type==t.TOKEN_FLOAT?r=parseFloat(i.value):i.type==t.TOKEN_BOOLEAN&&("true"==i.value?r=!0:"false"==i.value?r=!1:this.fail("invalid boolean: "+i.val,i.lineno,i.colno)):this.fail("expected expression, got end of file"),null!==r?s=new n.Literal(i.lineno,i.colno,r):i.type==t.TOKEN_SYMBOL?(s=new n.Symbol(i.lineno,i.colno,i.value),e||(s=this.parsePostfix(s))):(this.pushToken(i),s=this.parseAggregate()),s?s:void this.fail("unexpected token: "+i.value,i.lineno,i.colno)},parseFilter:function(e){for(;this.skip(t.TOKEN_PIPE);){for(var i=this.expect(t.TOKEN_SYMBOL),r=i.value;this.skipValue(t.TOKEN_OPERATOR,".");)r+="."+this.expect(t.TOKEN_SYMBOL).value;if(e=new n.Filter(i.lineno,i.colno,new n.Symbol(i.lineno,i.colno,r),new n.NodeList(i.lineno,i.colno,[e])),this.peekToken().type==t.TOKEN_LEFT_PAREN){var s=this.parsePostfix(e);e.args.children=e.args.children.concat(s.args.children)}}return e},parseAggregate:function(){var e,i=this.nextToken();switch(i.type){case t.TOKEN_LEFT_PAREN:e=new n.Group(i.lineno,i.colno);break;case t.TOKEN_LEFT_BRACKET:e=new n.Array(i.lineno,i.colno);break;case t.TOKEN_LEFT_CURLY:e=new n.Dict(i.lineno,i.colno);break;default:return null}for(;;){var r=this.peekToken().type;if(r==t.TOKEN_RIGHT_PAREN||r==t.TOKEN_RIGHT_BRACKET||r==t.TOKEN_RIGHT_CURLY){this.nextToken();break}if(e.children.length>0&&(this.skip(t.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",i.lineno,i.colno)),e instanceof n.Dict){var s=this.parsePrimary();this.skip(t.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",i.lineno,i.colno);var o=this.parseExpression();e.addChild(new n.Pair(s.lineno,s.colno,s,o))}else{var a=this.parseExpression();e.addChild(a)}}return e},parseSignature:function(e,i){var r=this.peekToken();if(!i&&r.type!=t.TOKEN_LEFT_PAREN){if(e)return null;this.fail("expected arguments",r.lineno,r.colno)}r.type==t.TOKEN_LEFT_PAREN&&(r=this.nextToken());for(var s=new n.NodeList(r.lineno,r.colno),o=new n.KeywordArgs(r.lineno,r.colno),a=!1;;){if(r=this.peekToken(),!i&&r.type==t.TOKEN_RIGHT_PAREN){this.nextToken();break}if(i&&r.type==t.TOKEN_BLOCK_END)break;if(a&&!this.skip(t.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",r.lineno,r.colno);else{var l=this.parseExpression();this.skipValue(t.TOKEN_OPERATOR,"=")?o.addChild(new n.Pair(l.lineno,l.colno,l,this.parseExpression())):s.addChild(l)}a=!0}return o.children.length&&s.addChild(o),s},parseUntilBlocks:function(){var e=this.breakOnBlocks;this.breakOnBlocks=r.toArray(arguments);var t=this.parse();return this.breakOnBlocks=e,t},parseNodes:function(){for(var e,i=[];e=this.nextToken();)if(e.type==t.TOKEN_DATA){var r=e.value,s=this.peekToken(),o=s&&s.value;this.dropLeadingWhitespace&&(r=r.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),s&&s.type==t.TOKEN_BLOCK_START&&"-"==o.charAt(o.length-1)&&(r=r.replace(/\s*$/,"")),i.push(new n.Output(e.lineno,e.colno,[new n.TemplateData(e.lineno,e.colno,r)]))}else if(e.type==t.TOKEN_BLOCK_START){var a=this.parseStatement();if(!a)break;i.push(a)}else if(e.type==t.TOKEN_VARIABLE_START){var l=this.parseExpression();this.advanceAfterVariableEnd(),i.push(new n.Output(e.lineno,e.colno,[l]))}else e.type!=t.TOKEN_COMMENT&&this.fail("Unexpected token at top-level: "+e.type,e.lineno,e.colno);return i},parse:function(){return new n.NodeList(0,0,this.parseNodes())},parseAsRoot:function(){return new n.Root(0,0,this.parseNodes())}});e.parser={parse:function(e,n){var i=new s(t.lex(e));return void 0!==n&&(i.extensions=n),i.parseAsRoot()}}}(),function(){function t(){return"hole_"+d++}function n(e,t){for(var n=null,i=0;i<e.length;i++){var r=t(e[i]);r!==e[i]&&(n||(n=e.slice()),n[i]=r)}return n||e}function i(e,t,r){if(!(e instanceof h.Node))return e;if(!r){var s=t(e);if(s&&s!==e)return s}if(e instanceof h.NodeList){var o=n(e.children,function(e){return i(e,t,r)});o!==e.children&&(e=new h[e.typename](e.lineno,e.colno,o))}else if(e instanceof h.CallExtension){var a=i(e.args,t,r),l=n(e.contentArgs,function(e){return i(e,t,r)});(a!==e.args||l!==e.contentArgs)&&(e=new h[e.typename](e.extName,e.prop,a,l))}else{var c=e.fields.map(function(t){return e[t]}),u=n(c,function(e){return i(e,t,r)});u!==c&&(e=new h[e.typename](e.lineno,e.colno),u.forEach(function(t,n){e[e.fields[n]]=t}))}return r?t(e)||e:e}function r(e,t){return i(e,t,!0)}function s(e,n,i){var s=[],o=r(i?e[i]:e,function(e){if(e instanceof h.Block)return e;if(e instanceof h.Filter&&-1!==n.indexOf(e.name.value)||e instanceof h.CallExtensionAsync){var i=new h.Symbol(e.lineno,e.colno,t());return s.push(new h.FilterAsync(e.lineno,e.colno,e.name,e.args,i)),i}});return i?e[i]=o:e=o,s.length?(s.push(e),new h.NodeList(e.lineno,e.colno,s)):e}function o(e,t){return r(e,function(e){return e instanceof h.Output?s(e,t):e instanceof h.For?s(e,t,"arr"):e instanceof h.If?s(e,t,"cond"):e instanceof h.CallExtension?s(e,t,"args"):void 0})}function a(e){return i(e,function(e){if(e instanceof h.Block){var n=!1,r=t();e.body=i(e.body,function(e){return e instanceof h.FunCall&&"super"==e.name.value?(n=!0,new h.Symbol(e.lineno,e.colno,r)):void 0}),n&&e.body.children.unshift(new h.Super(0,0,e.name,new h.Symbol(0,0,r)))}})}function l(e){return r(e,function(e){if(e instanceof h.If||e instanceof h.For){var t=!1;if(i(e,function(e){return e instanceof h.FilterAsync||e instanceof h.IfAsync||e instanceof h.AsyncEach||e instanceof h.AsyncAll||e instanceof h.CallExtensionAsync?(t=!0,e):void 0}),t){if(e instanceof h.If)return new h.IfAsync(e.lineno,e.colno,e.cond,e.body,e.else_);if(e instanceof h.For)return new h.AsyncEach(e.lineno,e.colno,e.arr,e.name,e.body)}}})}function c(e,t){return l(a(o(e,t)))}function u(e,t){return c(e,t||[])}var h=e.nodes,d=0;e.transformer={transform:u}}(),function(){function t(e){return function(t,n){this.compile(t.left,n),this.emit(e),this.compile(t.right,n)}}var n=e.lib,i=e.parser,r=e.transformer,s=e.nodes,o=e.object,a=e.runtime.Frame,l={"==":"==","!=":"!=","<":"<",">":">","<=":"<=",">=":">="},c=o.extend({init:function(){this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this.isChild=!1,this.scopeClosers=""},fail:function(e,t,i){throw void 0!==t&&(t+=1),void 0!==i&&(i+=1),new n.TemplateError(e,t,i)},pushBufferId:function(e){this.bufferStack.push(this.buffer),this.buffer=e,this.emit("var "+this.buffer+' = "";')},popBufferId:function(){this.buffer=this.bufferStack.pop()},emit:function(e){this.codebuf.push(e)},emitLine:function(e){this.emit(e+"\n")},emitLines:function(){n.each(n.toArray(arguments),function(e){this.emitLine(e)},this)},emitFuncBegin:function(e){this.buffer="output",this.scopeClosers="",this.emitLine("function "+e+"(env, context, frame, runtime, cb) {"),this.emitLine("var lineno = null;"),this.emitLine("var colno = null;"),this.emitLine("var "+this.buffer+' = "";'),this.emitLine("try {")},emitFuncEnd:function(e){e||this.emitLine("cb(null, "+this.buffer+");"),this.closeScopeLevels(),this.emitLine("} catch (e) {"),this.emitLine("  cb(runtime.handleError(e, lineno, colno));"),this.emitLine("}"),this.emitLine("}"),this.buffer=null},addScopeLevel:function(){this.scopeClosers+="})"},closeScopeLevels:function(){this.emitLine(this.scopeClosers+";"),this.scopeClosers=""},withScopedSyntax:function(e){var t=this.scopeClosers;this.scopeClosers="",e.call(this),this.closeScopeLevels(),this.scopeClosers=t},makeCallback:function(e){var t=this.tmpid();return"function("+t+(e?","+e:"")+") {\nif("+t+") { cb("+t+"); return; }"},tmpid:function(){return this.lastId++,"t_"+this.lastId},_bufferAppend:function(e){this.emit(this.buffer+" += runtime.suppressValue("),e.call(this),this.emit(", env.autoesc);\n")},_compileChildren:function(e,t){for(var n=e.children,i=0,r=n.length;r>i;i++)this.compile(n[i],t)},_compileAggregate:function(e,t,n,i){n&&this.emit(n);for(var r=0;r<e.children.length;r++)r>0&&this.emit(","),this.compile(e.children[r],t);i&&this.emit(i)},_compileExpression:function(e,t){this.assertType(e,s.Literal,s.Symbol,s.Group,s.Array,s.Dict,s.FunCall,s.Filter,s.LookupVal,s.Compare,s.InlineIf,s.And,s.Or,s.Not,s.Add,s.Sub,s.Mul,s.Div,s.FloorDiv,s.Mod,s.Pow,s.Neg,s.Pos,s.Compare,s.NodeList),this.compile(e,t)},assertType:function(e){for(var t=n.toArray(arguments).slice(1),i=!1,r=0;r<t.length;r++)e instanceof t[r]&&(i=!0);i||this.fail("assertType: invalid type: "+e.typename,e.lineno,e.colno)},compileCallExtension:function(e,t,i){var r=(e.extName,e.args),o=e.contentArgs,a="boolean"==typeof e.autoescape?e.autoescape:!0;if(i||this.emit(this.buffer+" += runtime.suppressValue("),this.emit('env.getExtension("'+e.extName+'")["'+e.prop+'"]('),this.emit("context"),(r||o)&&this.emit(","),r&&(r instanceof s.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),n.each(r.children,function(e,n){this._compileExpression(e,t),(n!=r.children.length-1||o.length)&&this.emit(",")},this)),o.length&&n.each(o,function(e,n){if(n>0&&this.emit(","),e){var i=this.tmpid();this.emitLine("function(cb) {"),this.emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}"),this.pushBufferId(i),this.withScopedSyntax(function(){this.compile(e,t),this.emitLine("cb(null, "+i+");")}),this.popBufferId(),this.emitLine("return "+i+";"),this.emitLine("}")}else this.emit("null")},this),i){var l=this.tmpid();this.emitLine(", "+this.makeCallback(l)),this.emitLine(this.buffer+" += runtime.suppressValue("+l+", "+a+" && env.autoesc);"),this.addScopeLevel()}else this.emit(")"),this.emit(", "+a+" && env.autoesc);\n")},compileCallExtensionAsync:function(e,t){this.compileCallExtension(e,t,!0)},compileNodeList:function(e,t){this._compileChildren(e,t)},compileLiteral:function(e){if("string"==typeof e.value){var t=e.value.replace(/\\/g,"\\\\");t=t.replace(/"/g,'\\"'),t=t.replace(/\n/g,"\\n"),t=t.replace(/\r/g,"\\r"),t=t.replace(/\t/g,"\\t"),this.emit('"'+t+'"')}else this.emit(e.value.toString())},compileSymbol:function(e,t){var n,i=e.value;this.emit((n=t.lookup(i))?n:'runtime.contextOrFrameLookup(context, frame, "'+i+'")')},compileGroup:function(e,t){this._compileAggregate(e,t,"(",")")},compileArray:function(e,t){this._compileAggregate(e,t,"[","]")},compileDict:function(e,t){this._compileAggregate(e,t,"{","}")},compilePair:function(e,t){var n=e.key,i=e.value;n instanceof s.Symbol?n=new s.Literal(n.lineno,n.colno,n.value):n instanceof s.Literal&&"string"==typeof n.value||this.fail("compilePair: Dict keys must be strings or names",n.lineno,n.colno),this.compile(n,t),this.emit(": "),this._compileExpression(i,t)},compileInlineIf:function(e,t){this.emit("("),this.compile(e.cond,t),this.emit("?"),this.compile(e.body,t),this.emit(":"),null!==e.else_?this.compile(e.else_,t):this.emit('""'),this.emit(")")},compileOr:t(" || "),compileAnd:t(" && "),compileAdd:t(" + "),compileSub:t(" - "),compileMul:t(" * "),compileDiv:t(" / "),compileMod:t(" % "),compileNot:function(e,t){this.emit("!"),this.compile(e.target,t)},compileFloorDiv:function(e,t){this.emit("Math.floor("),this.compile(e.left,t),this.emit(" / "),this.compile(e.right,t),this.emit(")")},compilePow:function(e,t){this.emit("Math.pow("),this.compile(e.left,t),this.emit(", "),this.compile(e.right,t),this.emit(")")},compileNeg:function(e,t){this.emit("-"),this.compile(e.target,t)},compilePos:function(e,t){this.emit("+"),this.compile(e.target,t)},compileCompare:function(e,t){this.compile(e.expr,t);for(var n=0;n<e.ops.length;n++){var i=e.ops[n];this.emit(" "+l[i.type]+" "),this.compile(i.expr,t)}},compileLookupVal:function(e,t){this.emit("runtime.memberLookup(("),this._compileExpression(e.target,t),this.emit("),"),this._compileExpression(e.val,t),this.emit(", env.autoesc)")},_getNodeName:function(e){switch(e.typename){case"Symbol":return e.value;case"FunCall":return"the return value of ("+this._getNodeName(e.name)+")";case"LookupVal":return this._getNodeName(e.target)+'["'+this._getNodeName(e.val)+'"]';case"Literal":return e.value.toString().substr(0,10);default:return"--expression--"}},compileFunCall:function(e,t){this.emit("(lineno = "+e.lineno+", colno = "+e.colno+", "),this.emit("runtime.callWrap("),this._compileExpression(e.name,t),this.emit(', "'+this._getNodeName(e.name).replace(/"/g,'\\"')+'", '),this._compileAggregate(e.args,t,"[","])"),this.emit(")")},compileFilter:function(e,t){var n=e.name;this.assertType(n,s.Symbol),this.emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this.emit(")")},compileFilterAsync:function(e,t){var n=e.name;this.assertType(n,s.Symbol);var i=e.symbol.value;t.set(i,i),this.emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this.emitLine(", "+this.makeCallback(i)),this.addScopeLevel()},compileKeywordArgs:function(e,t){var i=[];n.each(e.children,function(e){i.push(e.key.value)}),this.emit("runtime.makeKeywordArgs("),this.compileDict(e,t),this.emit(")")},compileSet:function(e,t){var i=[];n.each(e.targets,function(e){var n=e.value,r=t.lookup(n);null==r&&(r=this.tmpid(),this.emitLine("var "+r+";")),i.push(r)},this),this.emit(i.join(" = ")+" = "),this._compileExpression(e.value,t),this.emitLine(";"),n.each(e.targets,function(e,t){var n=i[t],r=e.value;this.emitLine('frame.set("'+r+'", '+n+", true);"),this.emitLine("if(!frame.parent) {"),this.emitLine('context.setVariable("'+r+'", '+n+");"),"_"!=r.charAt(0)&&this.emitLine('context.addExport("'+r+'");'),this.emitLine("}")},this)},compileIf:function(e,t,n){this.emit("if("),this._compileExpression(e.cond,t),this.emitLine(") {"),this.withScopedSyntax(function(){this.compile(e.body,t),n&&this.emit("cb()")}),e.else_?(this.emitLine("}\nelse {"),this.withScopedSyntax(function(){this.compile(e.else_,t),n&&this.emit("cb()")})):n&&(this.emitLine("}\nelse {"),this.emit("cb()")),this.emitLine("}")},compileIfAsync:function(e,t){this.emit("(function(cb) {"),this.compileIf(e,t,!0),this.emit("})(function() {"),this.addScopeLevel()},scanLoop:function(e){var t={};return e.iterFields(function(e){var i=e.findAll(s.LookupVal);n.each(i,function(e){e.target instanceof s.Symbol&&"loop"==e.target.value&&e.val instanceof s.Literal&&(t[e.val.value]=!0)})}),t},emitLoopBindings:function(e,t,n,i,r){r=r||n+".length";var s={index:i+" + 1",index0:i,revindex:r+" - "+i,revindex0:r+" - "+i+" - 1",first:i+" === 0",last:i+" === "+r+" - 1",length:r};for(var o in s)o in t&&this.emitLine('frame.set("loop.'+o+'", '+s[o]+");")},compileFor:function(e,t){var n=this.tmpid(),i=this.tmpid(),r=this.tmpid(),o=this.scanLoop(e);if(t=t.push(),this.emitLine("frame = frame.push();"),this.emit("var "+r+" = "),this._compileExpression(e.arr,t),this.emitLine(";"),this.emit("if("+r+") {"),e.name instanceof s.Array){this.emitLine("var "+n+";"),this.emitLine("if(runtime.isArray("+r+")) {"),this.emitLine("for("+n+"=0; "+n+" < "+r+".length; "+n+"++) {");for(var a=0;a<e.name.children.length;a++){var l=this.tmpid();this.emitLine("var "+l+" = "+r+"["+n+"]["+a+"]"),this.emitLine('frame.set("'+e.name.children[a].value+'", '+r+"["+n+"]["+a+"]);"),t.set(e.name.children[a].value,l)}this.emitLoopBindings(e,o,r,n),this.withScopedSyntax(function(){this.compile(e.body,t)}),this.emitLine("}"),this.emitLine("} else {");var c=e.name.children[0],u=e.name.children[1],h=this.tmpid(),d=this.tmpid();t.set(c.value,h),t.set(u.value,d),this.emitLine(n+" = -1;"),(o.revindex||o.revindex0||o.last||o.length)&&this.emitLine("var "+i+" = runtime.keys("+r+").length;"),this.emitLine("for(var "+h+" in "+r+") {"),this.emitLine(n+"++;"),this.emitLine("var "+d+" = "+r+"["+h+"];"),this.emitLine('frame.set("'+c.value+'", '+h+");"),this.emitLine('frame.set("'+u.value+'", '+d+");"),this.emitLoopBindings(e,o,r,n,i),this.withScopedSyntax(function(){this.compile(e.body,t)}),this.emitLine("}"),this.emitLine("}")}else{var d=this.tmpid();t.set(e.name.value,d),this.emitLine("for(var "+n+"=0; "+n+" < "+r+".length; "+n+"++) {"),this.emitLine("var "+d+" = "+r+"["+n+"];"),this.emitLine('frame.set("'+e.name.value+'", '+d+");"),this.emitLoopBindings(e,o,r,n),this.withScopedSyntax(function(){this.compile(e.body,t)}),this.emitLine("}")}this.emitLine("}"),this.emitLine("frame = frame.pop();")},_compileAsyncLoop:function(e,t,i){var r=this.tmpid(),o=this.tmpid(),a=this.tmpid(),l=this.scanLoop(e),c=i?"asyncAll":"asyncEach";if(t=t.push(),this.emitLine("frame = frame.push();"),this.emit("var "+a+" = "),this._compileExpression(e.arr,t),this.emitLine(";"),e.name instanceof s.Array)this.emit("runtime."+c+"("+a+", "+e.name.children.length+", function("),n.each(e.name.children,function(e){this.emit(e.value+",")},this),this.emit(r+","+o+",next) {"),n.each(e.name.children,function(e){var n=e.value;t.set(n,n),this.emitLine('frame.set("'+n+'", '+n+");")},this);else{var u=e.name.value;this.emitLine("runtime."+c+"("+a+", 1, function("+u+", "+r+", "+o+",next) {"),this.emitLine('frame.set("'+u+'", '+u+");"),t.set(u,u)}this.emitLoopBindings(e,l,a,r,o),this.withScopedSyntax(function(){var n;i&&(n=this.tmpid(),this.pushBufferId(n)),this.compile(e.body,t),this.emitLine("next("+r+(n?","+n:"")+");"),i&&this.popBufferId()});var h=this.tmpid();this.emitLine("}, "+this.makeCallback(h)),this.addScopeLevel(),i&&this.emitLine(this.buffer+" += "+h+";"),this.emitLine("frame = frame.pop();")},compileAsyncEach:function(e,t){this._compileAsyncLoop(e,t)},compileAsyncAll:function(e,t){this._compileAsyncLoop(e,t,!0)},_emitMacroBegin:function(e,t){var i=[],r=null,o="macro_"+this.tmpid();n.each(e.args.children,function(t,n){n===e.args.children.length-1&&t instanceof s.Dict?r=t:(this.assertType(t,s.Symbol),i.push(t))},this);var a=n.map(i,function(e){return"l_"+e.value});a.push("kwargs");var l=n.map(i,function(e){return'"'+e.value+'"'}),c=n.map(r&&r.children||[],function(e){return'"'+e.key.value+'"'});return this.emitLines("var "+o+" = runtime.makeMacro(","["+l.join(", ")+"], ","["+c.join(", ")+"], ","function ("+a.join(", ")+") {","frame = frame.push();","kwargs = kwargs || {};"),n.each(i,function(e){this.emitLine('frame.set("'+e.value+'", l_'+e.value+");"),t.set(e.value,"l_"+e.value)},this),r&&n.each(r.children,function(e){var n=e.key.value;this.emit('frame.set("'+n+'", kwargs.hasOwnProperty("'+n+'") ? kwargs["'+n+'"] : '),this._compileExpression(e.value,t),this.emitLine(");")},this),o},_emitMacroEnd:function(e){this.emitLine("frame = frame.pop();"),this.emitLine("return new runtime.SafeString("+e+");"),this.emitLine("});")},compileMacro:function(e,t){t=t.push();var n=this._emitMacroBegin(e,t),i=this.tmpid();this.pushBufferId(i),this.withScopedSyntax(function(){this.compile(e.body,t)}),this._emitMacroEnd(i),this.popBufferId();var r=e.name.value;t=t.pop(),t.set(r,n),t.parent?this.emitLine('frame.set("'+r+'", '+n+");"):("_"!=e.name.value.charAt(0)&&this.emitLine('context.addExport("'+r+'");'),this.emitLine('context.setVariable("'+r+'", '+n+");"))},compileImport:function(e,t){var n=this.tmpid(),i=e.target.value;this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", "+this.makeCallback(n)),this.addScopeLevel(),this.emitLine(n+".getExported("+this.makeCallback(n)),this.addScopeLevel(),t.set(i,n),this.emitLine(t.parent?'frame.set("'+i+'", '+n+");":'context.setVariable("'+i+'", '+n+");")},compileFromImport:function(e,t){var i=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", "+this.makeCallback(i)),this.addScopeLevel(),this.emitLine(i+".getExported("+this.makeCallback(i)),this.addScopeLevel(),n.each(e.names.children,function(e){var n,r,o=this.tmpid();e instanceof s.Pair?(n=e.key.value,r=e.value.value):(n=e.value,r=n),this.emitLine("if("+i+'.hasOwnProperty("'+n+'")) {'),this.emitLine("var "+o+" = "+i+"."+n+";"),this.emitLine("} else {"),this.emitLine("cb(new Error(\"cannot import '"+n+"'\")); return;"),this.emitLine("}"),t.set(r,o),this.emitLine(t.parent?'frame.set("'+r+'", '+o+");":'context.setVariable("'+r+'", '+o+");")},this)},compileBlock:function(e){if(!this.isChild){var t=this.tmpid();this.emitLine('context.getBlock("'+e.name.value+'")(env, context, frame, runtime, '+this.makeCallback(t)),this.emitLine(this.buffer+" += "+t+";"),this.addScopeLevel()}},compileSuper:function(e,t){var n=e.blockName.value,i=e.symbol.value;this.emitLine('context.getSuper(env, "'+n+'", b_'+n+", frame, runtime, "+this.makeCallback(i)),this.emitLine(i+" = runtime.markSafe("+i+");"),this.addScopeLevel(),t.set(i,i)},compileExtends:function(e,t){this.isChild&&this.fail("compileExtends: cannot extend multiple times",e.template.lineno,e.template.colno);var n=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", true, "+this.makeCallback("parentTemplate")),this.emitLine("for(var "+n+" in parentTemplate.blocks) {"),this.emitLine("context.addBlock("+n+", parentTemplate.blocks["+n+"]);"),this.emitLine("}"),this.addScopeLevel(),this.isChild=!0},compileInclude:function(e,t){var n=this.tmpid(),i=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", "+this.makeCallback(n)),this.addScopeLevel(),this.emitLine(n+".render(context.getVariables(), frame.push(), "+this.makeCallback(i)),this.emitLine(this.buffer+" += "+i),this.addScopeLevel()},compileTemplateData:function(e,t){this.compileLiteral(e,t)},compileOutput:function(e,t){for(var n=e.children,i=0,r=n.length;r>i;i++)n[i]instanceof s.TemplateData?n[i].value&&(this.emit(this.buffer+" += "),this.compileLiteral(n[i],t),this.emitLine(";")):(this.emit(this.buffer+" += runtime.suppressValue("),this.compile(n[i],t),this.emit(", env.autoesc);\n"))},compileRoot:function(e,t){t&&this.fail("compileRoot: root node can't have frame"),t=new a,this.emitFuncBegin("root"),this._compileChildren(e,t),this.isChild&&this.emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this.emitFuncEnd(this.isChild),this.isChild=!1;for(var n=e.findAll(s.Block),i=0;i<n.length;i++){var r=n[i],o=r.name.value;this.emitFuncBegin("b_"+o);var l=new a;this.compile(r.body,l),this.emitFuncEnd()}this.emitLine("return {");for(var i=0;i<n.length;i++){var r=n[i],o="b_"+r.name.value;this.emitLine(o+": "+o+",")}this.emitLine("root: root\n};")},compile:function(e,t){var n=this["compile"+e.typename];n?n.call(this,e,t):this.fail("compile: Cannot compile node: "+e.typename,e.lineno,e.colno)},getCode:function(){return this.codebuf.join("")}});e.compiler={compile:function(e,t,n,s){var o=new c;if(n&&n.length)for(var a=0;a<n.length;a++)"preprocess"in n[a]&&(e=n[a].preprocess(e,s));return o.compile(r.transform(i.parse(e,n),t,s)),o.getCode()},Compiler:c}}(),function(){var t=e.lib,n=e.runtime,i={abs:function(e){return Math.abs(e)},batch:function(e,t,n){for(var i=[],r=[],s=0;s<e.length;s++)s%t===0&&r.length&&(i.push(r),r=[]),r.push(e[s]);if(r.length){if(n)for(var s=r.length;t>s;s++)r.push(n);i.push(r)}return i},capitalize:function(e){var t=e.toLowerCase();return n.copySafeness(e,t.charAt(0).toUpperCase()+t.slice(1))},center:function(e,i){if(i=i||80,e.length>=i)return e;var r=i-e.length,s=t.repeat(" ",r/2-r%2),o=t.repeat(" ",r/2);return n.copySafeness(e,s+e+o)},"default":function(e,t){return e?e:t},dictsort:function(e,n,i){if(!t.isObject(e))throw new t.TemplateError("dictsort filter: val must be an object");var r=[];for(var s in e)r.push([s,e[s]]);var o;if(void 0===i||"key"===i)o=0;else{if("value"!==i)throw new t.TemplateError("dictsort filter: You can only sort by either key or value");o=1}return r.sort(function(e,i){var r=e[o],s=i[o];return n||(t.isString(r)&&(r=r.toUpperCase()),t.isString(s)&&(s=s.toUpperCase())),r>s?1:r==s?0:-1}),r},escape:function(e){return"string"==typeof e||e instanceof n.SafeString?t.escape(e):e
},safe:function(e){return n.markSafe(e)},first:function(e){return e[0]},groupby:function(e,n){return t.groupBy(e,n)},indent:function(e,i,r){i=i||4;for(var s="",o=e.split("\n"),a=t.repeat(" ",i),l=0;l<o.length;l++)s+=0!=l||r?a+o[l]+"\n":o[l]+"\n";return n.copySafeness(e,s)},join:function(e,n,i){return n=n||"",i&&(e=t.map(e,function(e){return e[i]})),e.join(n)},last:function(e){return e[e.length-1]},length:function(e){return void 0!==e?e.length:0},list:function(e){if(t.isString(e))return e.split("");if(t.isObject(e)){var n=[];if(Object.keys)n=Object.keys(e);else for(var i in e)n.push(i);return t.map(n,function(t){return{key:t,value:e[t]}})}throw new t.TemplateError("list filter: type not iterable")},lower:function(e){return e.toLowerCase()},random:function(e){return e[Math.floor(Math.random()*e.length)]},replace:function(e,t,i,r){var s=e,o=s,a=1;for(s=s.replace(t,i);o!=s&&!(a>=r);)o=s,s=s.replace(t,i),a++;return n.copySafeness(e,s)},reverse:function(e){var r;return r=t.isString(e)?i.list(e):t.map(e,function(e){return e}),r.reverse(),t.isString(e)?n.copySafeness(e,r.join("")):r},round:function(e,t,n){t=t||0;var i,r=Math.pow(10,t);return i="ceil"==n?Math.ceil:"floor"==n?Math.floor:Math.round,i(e*r)/r},slice:function(e,t,n){for(var i=Math.floor(e.length/t),r=e.length%t,s=0,o=[],a=0;t>a;a++){var l=s+a*i;r>a&&s++;var c=s+(a+1)*i,u=e.slice(l,c);n&&a>=r&&u.push(n),o.push(u)}return o},sort:function(e,n,i,r){return e=t.map(e,function(e){return e}),e.sort(function(e,s){var o,a;return r?(o=e[r],a=s[r]):(o=e,a=s),!i&&t.isString(o)&&t.isString(a)&&(o=o.toLowerCase(),a=a.toLowerCase()),a>o?n?1:-1:o>a?n?-1:1:0}),e},string:function(e){return n.copySafeness(e,e)},title:function(e){for(var t=e.split(" "),r=0;r<t.length;r++)t[r]=i.capitalize(t[r]);return n.copySafeness(e,t.join(" "))},trim:function(e){return n.copySafeness(e,e.replace(/^\s*|\s*$/g,""))},truncate:function(e,t,i,r){var s=e;if(t=t||255,e.length<=t)return e;if(i)e=e.substring(0,t);else{var o=e.lastIndexOf(" ",t);-1===o&&(o=t),e=e.substring(0,o)}return e+=void 0!==r&&null!==r?r:"...",n.copySafeness(s,e)},upper:function(e){return e.toUpperCase()},urlencode:function(e){var n=encodeURIComponent;if(t.isString(e))return n(e);var i;if(t.isArray(e))i=e.map(function(e){return n(e[0])+"="+n(e[1])});else{i=[];for(var r in e)e.hasOwnProperty(r)&&i.push(n(r)+"="+n(e[r]))}return i.join("&")},urlize:function(e,t,n){isNaN(t)&&(t=1/0);var i=n===!0?' rel="nofollow"':"",r=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,s=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,o=/^https?:\/\/.*$/,a=/^www\./,l=/\.(?:org|net|com)(?:\:|\/|$)/,c=e.split(/\s+/).filter(function(e){return e&&e.length}).map(function(e){var n=e.match(r),c=n&&n[1]||e;return o.test(c)?'<a href="'+c+'"'+i+">"+c.substr(0,t)+"</a>":a.test(c)?'<a href="http://'+c+'"'+i+">"+c.substr(0,t)+"</a>":s.test(c)?'<a href="mailto:'+c+'">'+c+"</a>":l.test(c)?'<a href="http://'+c+'"'+i+">"+c.substr(0,t)+"</a>":c});return c.join(" ")},wordcount:function(e){var t=e?e.match(/\w+/g):null;return t?t.length:null},"float":function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},"int":function(e,t){var n=parseInt(e,10);return isNaN(n)?t:n}};i.d=i["default"],i.e=i.escape,e.filters=i}(),function(){function t(e){var t=-1,n=null;return{reset:function(){t=-1,n=null},next:function(){return t++,t>=e.length&&(t=0),n=e[t]}}}function n(e){e=e||",";var t=!0;return function(){var n=t?"":e;return t=!1,n}}var i={range:function(e,t,n){t?n||(n=1):(t=e,e=0,n=1);for(var i=[],r=e;t>r;r+=n)i.push(r);return i},cycler:function(){return t(Array.prototype.slice.call(arguments))},joiner:function(e){return n(e)}};e.globals=i}(),function(){var t=e.object,n=e.lib,i=t.extend({on:function(e,t){this.listeners=this.listeners||{},this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t)},emit:function(e){var t=Array.prototype.slice.call(arguments,1);this.listeners&&this.listeners[e]&&n.each(this.listeners[e],function(e){e.apply(null,t)})}});e.loader=i}(),function(){var t=e.loader,n=t.extend({init:function(e,t){this.precompiled=window.nunjucksPrecompiled||{},this.baseURL=e||"",this.neverUpdate=t},getSource:function(e){if(this.precompiled[e])return{src:{type:"code",obj:this.precompiled[e]},path:e};var t=this.fetch(this.baseURL+"/"+e);return t?{src:t,path:e,noCache:!this.neverUpdate}:null},fetch:function(e){var t,n,i=!0;return window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t.onreadystatechange=function(){4!==t.readyState||0!==t.status&&200!==t.status||!i||(i=!1,n=t.responseText)},e+=(-1===e.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),t.open("GET",e,!1),t.send(),n}});e["web-loaders"]={WebLoader:n}}(),function(){e.loaders="undefined"==typeof window||window!==this?e["node-loaders"]:e["web-loaders"]}(),function(){var t=e.path,n=e.lib,i=e.object,r=e.lexer,s=e.compiler,o=e.filters,a=e.loaders,l=e.runtime,c=e.globals,u=l.Frame,h=i.extend({init:function(e,t){t=t||{},this.dev=!!t.dev,this.autoesc=!!t.autoescape,this.loaders=e?n.isArray(e)?e:[e]:a.FileSystemLoader?[new a.FileSystemLoader("views")]:[new a.WebLoader("/views")],this.initCache(),this.filters={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],t.tags&&r.setTags(t.tags);for(var i in o)this.addFilter(i,o[i])},initCache:function(){var e={};n.each(this.loaders,function(t){"function"==typeof t.on&&t.on("update",function(t){e[t]=null})}),this.cache=e},addExtension:function(e,t){t._name=e,this.extensions[e]=t,this.extensionsList.push(t)},getExtension:function(e){return this.extensions[e]},addGlobal:function(e,t){c[e]=t},addFilter:function(e,t,n){var i=t;n&&this.asyncFilters.push(e),this.filters[e]=i},getFilter:function(e){if(!this.filters[e])throw new Error("filter not found: "+e);return this.filters[e]},getTemplate:function(e,t,i){if(e&&e.raw&&(e=e.raw),n.isFunction(t)&&(i=t,t=!1),"string"!=typeof e)throw new Error("template names must be a string: "+e);var r=this.cache[e];if(!r){var s;return n.asyncIter(this.loaders,function(t,n,i,r){function s(e){e?r(e):i()}t.async?t.getSource(e,function(e,t){if(e)throw e;s(t)}):s(t.getSource(e))},function(n){if(n){var r=new p(n.src,this,n.path,t);n.noCache||(this.cache[e]=r),i?i(null,r):s=r}else{var o=new Error("template not found: "+e);if(!i)throw o;i(o)}}.bind(this)),s}return t&&r.compile(),i?void i(null,r):r},express:function(e){function n(e,n){if(this.name=e,this.path=e,this.defaultEngine=n.defaultEngine,this.ext=t.extname(e),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}var i=this;n.prototype.render=function(e,t){i.render(this.name,e,t)},e.set("view",n)},render:function(e,t,i){n.isFunction(t)&&(i=t,t=null);var r=null;return this.getTemplate(e,function(e,n){if(e&&i)i(e);else{if(e)throw e;n.render(t,i||function(e,t){if(e)throw e;r=t})}}),r},renderString:function(e,t,n){var i=new p(e,this);return i.render(t,n)}}),d=i.extend({init:function(e,t){this.ctx=e,this.blocks={},this.exported=[];for(var n in t)this.addBlock(n,t[n])},lookup:function(e){return e in c&&!(e in this.ctx)?c[e]:this.ctx[e]},setVariable:function(e,t){this.ctx[e]=t},getVariables:function(){return this.ctx},addBlock:function(e,t){this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t)},getBlock:function(e){if(!this.blocks[e])throw new Error('unknown block "'+e+'"');return this.blocks[e][0]},getSuper:function(e,t,n,i,r,s){var o=(this.blocks[t]||[]).indexOf(n),a=this.blocks[t][o+1],l=this;if(-1==o||!a)throw new Error('no super block available for "'+t+'"');a(e,l,i,r,s)},addExport:function(e){this.exported.push(e)},getExported:function(){for(var e={},t=0;t<this.exported.length;t++){var n=this.exported[t];e[n]=this.ctx[n]}return e}}),p=i.extend({init:function(e,t,i,r){if(this.env=t||new h,n.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj}else{if(!n.isString(e))throw new Error("src must be a string or an object describing the source");this.tmplStr=e}this.path=i,r?n.withPrettyErrors(this.path,this.env.dev,this._compile.bind(this)):this.compiled=!1},render:function(e,t,i){return"function"==typeof e?(i=e,e={}):"function"==typeof t&&(i=t,t=null),n.withPrettyErrors(this.path,this.env.dev,function(){this.compile();var n=new d(e||{},this.blocks),r=null;return this.rootRenderFunc(this.env,n,t||new u,l,i||function(e,t){if(e)throw e;r=t}),r}.bind(this))},getExported:function(e){this.compile();var t=new d({},this.blocks);this.rootRenderFunc(this.env,t,new u,l,function(){e(null,t.getExported())})},compile:function(){this.compiled||this._compile()},_compile:function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=s.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path),n=new Function(t);e=n()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},_getBlocks:function(e){var t={};for(var n in e)"b_"==n.slice(0,2)&&(t[n.slice(2)]=e[n]);return t}});e.environment={Environment:h,Template:p}}();var n,i=e.lib,r=e.environment,s=e.compiler,o=e.parser,a=e.lexer,l=e.runtime,c=e.loader,u=e.loaders,h=e.precompile;n={},n.Environment=r.Environment,n.Template=r.Template,n.Loader=c,n.FileSystemLoader=u.FileSystemLoader,n.WebLoader=u.WebLoader,n.compiler=s,n.parser=o,n.lexer=a,n.runtime=l;var d;n.configure=function(e,t){t=t||{},i.isObject(e)&&(t=e,e=null);var n="watch"in t?!t.watch:!1,s=u.FileSystemLoader||u.WebLoader;return d=new r.Environment(new s(e,n),t),t&&t.express&&d.express(t.express),d},n.compile=function(e,t,i,r){return d||n.configure(),new n.Template(e,t,i,r)},n.render=function(e,t,i){return d||n.configure(),d.render(e,t,i)},n.renderString=function(e,t,i){return d||n.configure(),d.renderString(e,t,i)},h&&(n.precompile=h.precompile,n.precompileString=h.precompileString),n.require=function(t){return e[t]},"function"==typeof define&&define.amd?define(function(){return n}):(window.nunjucks=n,"undefined"!=typeof t&&(t.exports=n))}()},{}],43:[function(e,t){!function(e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof t&&t&&"object"==typeof t.exports?t.exports=n():e.analytics=n()}(this,function(){function e(e){var n=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;return e=t(e),e.replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(e,t,i){return t>0&&t+e.length!==i.length&&e.search(n)>-1&&":"!==i.charAt(t-2)&&("-"!==i.charAt(t+e.length)||"-"===i.charAt(t-1))&&i.charAt(t-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)})}function t(e){return e.replace(/^\s+|\s+$/g,"")}function n(e){return/[^@]+@[^@]+/.test(e)}function i(e){console.warn("[analytics] "+e)}function r(e){if("function"==typeof ga){var t={hitType:"event",eventCategory:h,eventAction:e.action};e.label&&(t.eventLabel=e.label),(e.value||0===e.value)&&(t.eventValue=e.value),e.nonInteraction===!0&&(t.nonInteraction=1),ga("send",t)}var n=["_trackEvent",h,e.action];e.label&&(n[3]=e.label),(e.value||0===e.value)&&(n[4]=e.value),e.nonInteraction===!0&&(n[5]=!0),_gaq.push(n)}function s(s,o){o=o||{};var a={},l=o.label,c=o.value,u=o.noninteraction||o.nonInteraction;return s?(n(s)&&(i("`action` arg looks like an email address, redacting."),s=d),a.action=e(s),l&&("string"!=typeof l?i("Expected `label` arg to be a String."):(n(l)&&(i("`label` arg looks like an email address, redacting."),l=d),a.label=t(l))),(c||0===c)&&("number"!=typeof c?i("Expected `value` arg to be a Number."):a.value=0|c),u&&("boolean"!=typeof u?i("Expected `noninteraction` arg to be a Boolean."):a.nonInteraction=u===!0),void r(a)):void i("Expected `action` arg.")}function o(e){return/^\/virtual\//.test(e)?e:(e=e.replace(/^[/]?/,"/"),"/virtual"+e)}function a(e){if("function"==typeof ga){var t={hitType:"pageview",page:e.virtualPagePath};ga("send",t)}var n=["_trackPageview",e.virtualPagePath];_gaq.push(n)}function l(e){if(!e)return void i("Expected `virtualPagePath` arg.");e=t(e);var n={};n.virtualPagePath=o(e),a(n)}function c(e){var t=["trackEvent",e.action];if(e.revenue){var n={revenue:e.revenue};t[2]=n}optimizely.push(t)}function u(e,n){n=n||{};var r={},s=n.valueInCents;return e?(r.action=t(e),s&&("number"==typeof s&&s%1===0?r.revenue=s:i("Expected `valueInCents` arg to be an integer.")),void c(r)):void i("Expected `action` arg.")}this._gaq||(this._gaq=[]),this.optimizely||(this.optimizely=[]);var h=location.hostname,d="REDACTED (Potential Email Address)";return{event:s,virtualPageview:l,conversionGoal:u}})},{}],44:[function(e,t){function n(e,t,n){if(e){var i=e.querySelectorAll(t);if(i)for(var r=0;r<i.length;r++)n(r,i[r])}}var i=e("angular-expressions"),r=e("events").EventEmitter,s=e("nunjucks"),o=e("url"),a=e("util"),l=e("../core"),c={"en-US":e("../../locale/en_US/webmaker-login.json")},u=new s.Environment;u.addFilter("i18n",function(e){return c["en-US"][e].message});var h={lang:"en-US"};i.filters.i18n=function(e){return c["en-US"][e].message};var d={create:u.renderString('<div class="modal-header">\n  <button ng-click="close()" ng-hide="" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n  <h3 class="modal-title" ng-hide="currentState === MODALSTATE.welcome">\n    <a href="#" ng-click="close()" class="modal-title-left">{{ \'Cancel\' | i18n }}</a>\n    <span class="modal-title-center">{{ \'webmakerAuthCreateWelcome\' | i18n }}</span>\n    <button\n      ng-show="currentState === MODALSTATE.inputEmail"\n      href="#" ng-click="submitEmail()" ng-disabled="!user.email || form.user.$error.accountExists || form.user.$error.invalidEmail" tabindex="3" class="btn-link modal-title-right">{{ \'Next\' | i18n }}</button>\n    <button\n      ng-show="currentState === MODALSTATE.inputUsername"\n      ng-disabled="!user.username || form.user.$error.invalidUsername || form.user.$error.usernameTaken || sendingRequest" ng-click="submitUser()" class="btn-link create-user modal-title-right" tabindex="5">{{ \'Sign up\' | i18n }}</button>\n  </h3>\n  <h3 class="modal-title" ng-show="currentState === MODALSTATE.welcome">\n    <a href="#" ng-click="close()" class="modal-title-left">{{ \'Cancel\' | i18n }}</a>\n    <span>{{ \'webmakerAuthWelcome\' | i18n }}</span>\n    <a href="#" ng-click="close()" class="modal-title-right">{{ \'Done\' | i18n }}</a>\n  </h3>\n</div>\n<div class="modal-body">\n  <form class="form" name="form.user" novalidate>\n    <div ng-show="currentState === MODALSTATE.inputEmail">\n      <div class="form-group">\n        <label for="webmaker-login-email">{{ \'Email\' | i18n }}</label>\n        <input id="webmaker-login-email" ng-model="user.email" ng-keyup="validateEmail();" type="text" class="form-control" name="email" autocomplete="off" autofocus tabindex="1" required focus-on="create-user-email">\n      </div>\n      <div class="alert alert-danger" ng-show="form.user.$error.agreeToTerms" ng-bind-html="\'webmakerAuthAgreeError\' | i18n"></div>\n      <div class="alert alert-warning" ng-show="form.user.$error.accountExists" bind-trusted-html="\'WebmakerAccountExists\' | i18n"></div>\n      <div class="alert alert-danger" ng-show="form.user.$error.invalidEmail" ng-bind-html="\'NotAnEmail\' | i18n"></div>\n      <div class="terms-checkbox checkbox">\n        <input id="agree-to-terms" ng-model="user.agree" type="checkbox" ng-disabled="form.user.$error.accountExists" ng-change="agreeToTermsChanged();" name="agree" tabindex="2">\n        <label for="agree-to-terms" tabindex="2">\n          <div><span></span></div>\n          <span ng-bind-html="\'webmakerAuthAgreeToTerms\' | i18n"></span>\n        </label>\n      </div>\n      <div class="mailing-list-checkbox checkbox">\n        <input id="subscribe-to-list" ng-model="user.subscribeToList" type="checkbox" ng-disabled="form.user.$error.accountExists" name="subscribeToList" tabindex="2">\n        <label for="subscribe-to-list" tabindex="2">\n          <div><span></span></div>\n          <span ng-bind-html="\'webmakerAuthMailingList\' | i18n"></span>\n        </label>\n      </div>\n      <div class="cta-links clearfix">\n        <button ng-click="submitEmail()" ng-disabled="!user.email || form.user.$error.accountExists || form.user.$error.invalidEmail" class="create-user btn btn-primary hidden-xs-login" type="button" tabindex="3">{{ \'Sign up\' | i18n }}</button>\n      </div>\n    </div>\n\n    <div ng-show="currentState === MODALSTATE.inputUsername">\n      <div class="form-group">\n        <label for="pre-username">{{ \'webmakerAuthChooseUsername\' | i18n }}</label>\n        <label for="username" class="hidden-xs-login">webmaker.org/user/</label>\n        <input ng-model="user.username" name="username" ng-change="validateUsername()" class="form-control username" autocomplete="off" required autofocus tabindex="4" focus-on="create-user-username" maxlength="20" minlength="1">\n        <div class="visible-xs help-block text-center">webmaker.org/user/<strong class="username-with-url">{{user.username}}</strong></div>\n      </div>\n      <div class="alert alert-danger" ng-show="form.user.$error.invalidUsername" ng-bind-html="\'webmakerAuthUsernameInvalid\' | i18n"></div>\n      <div class="alert alert-danger" ng-show="form.user.$error.serverError" ng-bind-html="\'webmakerAuthServerError\' | i18n"></div>\n      <div class="alert alert-danger" ng-show="form.user.$error.usernameTaken" ng-bind-html="\'webmakerAuthTakenError\' | i18n"></div>\n      <div ng-show="skippedEmail" class="mailing-list-checkbox checkbox">\n        <input id="subscribe-to-list" ng-model="user.subscribeToList" type="checkbox" ng-disabled="form.user.$error.accountExists" name="subscribeToList" tabindex="2">\n        <label for="subscribe-to-list" tabindex="2">\n          <div><span></span></div>\n          <span ng-bind-html="\'webmakerAuthMailingList\' | i18n"></span>\n        </label>\n      </div>\n      <button ng-disabled="!user.username || form.user.$error.invalidUsername || form.user.$error.usernameTaken || sendingRequest" ng-click="submitUser()" class="create-user btn btn-primary hidden-xs-login" type="button" tabindex="5">{{ \'webmakerAuthCreateAccount\' | i18n }}</button>\n    </div>\n\n    <div ng-show="currentState === MODALSTATE.welcome" class="welcome">\n      <p class="subheadline">{{ \'aboutWebmaker\' | i18n }}</p>\n\n        <!-- Goggles -->\n        <div class="tool-desc" ng-show="welcomeModalIdx === 0">\n          <div class="icon">\n            <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n            <svg width="276px" height="210px" viewBox="0 0 276 210" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n              <title>Goggles</title>\n              <desc>XRay Goggles.</desc>\n              <defs></defs>\n              <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n                <g id="Artboard-27" sketch:type="MSArtboardGroup" transform="translate(-8.000000, -25.000000)">\n                  <g id="goggles" sketch:type="MSLayerGroup" transform="translate(8.000000, 25.000000)">\n                    <path d="M256.460878,100.757257 C254.300432,98.595 248.740338,93.6349115 244.461405,91.3416372 L87.2010811,2.31836283 C82.0372703,-0.216504425 74.6962297,-1.41238938 69.0606081,4.21300885 C63.4091351,9.83747788 64.2679054,16.7711947 66.8740541,21.7935398 L156.207608,178.545531 C158.362459,181.89531 163.757514,188.816947 165.933811,190.960619 C190.938851,215.872566 231.455838,215.88 256.460878,190.960619 C281.469649,166.057965 281.469649,125.658982 256.460878,100.757257" id="Fill-1" fill="#ECA5C0" sketch:type="MSShapeGroup"></path>\n                    <path d="M206.411635,4.22137168 C200.776946,-1.41238938 193.033095,-0.216504425 188.474432,2.21336283 L32.3423514,90.5518142 C27.5645676,93.5884513 21.1746081,98.595 19.0113649,100.757257 C-5.99367568,125.658982 -5.99367568,166.057965 19.0113649,190.960619 C44.015473,215.872566 84.5389865,215.872566 109.525378,190.960619 C111.700743,188.816947 116.493446,182.464912 118.293041,180.08708 L208.316595,22.2302655 C211.235108,17.7031858 212.050986,9.83747788 206.411635,4.22137168" id="Fill-2" fill="#59B3D7" sketch:type="MSShapeGroup"></path>\n                    <path d="M137.699757,146.04292 L187.347122,58.9867699 L137.736122,30.9025221 L88.0896892,58.9923451 L137.699757,146.04292" id="Fill-3" fill="#4E72A7" sketch:type="MSShapeGroup"></path>\n                    <path d="M19.0113649,190.960619 C-5.99367568,166.057965 -5.99367568,125.658982 19.0113649,100.757257 C44.015473,75.8360177 84.5389865,75.8360177 109.525378,100.757257 C134.526689,125.658982 134.526689,166.057965 109.525378,190.960619 C84.5389865,215.872566 44.015473,215.872566 19.0113649,190.960619" id="Fill-4" fill="#369ECD" sketch:type="MSShapeGroup"></path>\n                    <path d="M256.526149,190.960619 C231.520176,215.88 191.001324,215.872566 165.995351,190.960619 C140.994041,166.057965 140.994041,125.667345 165.995351,100.747965 C191.001324,75.8360177 231.520176,75.8360177 256.526149,100.757257 C281.532122,125.658982 281.532122,166.057965 256.526149,190.960619" id="Fill-5" fill="#E36D9E" sketch:type="MSShapeGroup"></path>\n                    <path d="M235.671365,172.371903 C222.429892,185.550796 200.976486,185.550796 187.746203,172.371903 C174.501,159.16885 174.501,137.799027 187.746203,124.595044 C200.976486,111.409646 222.429892,111.409646 235.671365,124.612699 C248.903514,137.799027 248.903514,159.16885 235.671365,172.371903" id="Fill-6" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n                    <path d="M211.686405,130.685973 C197.874284,130.685973 186.669243,142.526814 186.669243,147.321504 C186.669243,148.542478 187.402135,149.697478 188.704743,150.735398 C189.952338,148.202389 191.521622,145.792035 193.651297,143.673451 C195.952541,141.379248 198.579203,139.622124 201.369041,138.337035 C195.774446,143.999602 195.790297,153.095575 201.451095,158.720973 C207.112824,164.37146 216.304743,164.37146 221.987919,158.720973 C227.658041,153.061195 227.658041,143.897389 221.987919,138.246903 C221.513311,137.773938 220.980892,137.392035 220.455,137.00177 C224.543716,138.231106 228.400257,140.452832 231.635797,143.673451 C233.390635,145.410133 234.738,147.370752 235.893284,149.405708 C236.381878,148.741327 236.7045,148.044425 236.7045,147.321504 C236.7045,142.526814 225.511581,130.685973 211.686405,130.685973 L211.686405,130.685973 Z M220.613514,144.661195 C220.613514,146.779779 218.886649,148.491372 216.75977,148.491372 C214.626365,148.491372 212.908824,146.779779 212.908824,144.661195 C212.908824,142.542611 214.626365,140.822655 216.75977,140.822655 C218.886649,140.822655 220.613514,142.542611 220.613514,144.661195 L220.613514,144.661195 Z" id="Fill-7" fill="#E36D9E" sketch:type="MSShapeGroup"></path>\n                    <path d="M86.2761081,172.371903 C73.0467568,185.550796 51.5765676,185.550796 38.3490811,172.371903 C25.1048108,159.16885 25.1048108,137.799027 38.3490811,124.595044 C51.5765676,111.409646 73.0467568,111.409646 86.2761081,124.612699 C99.5073243,137.799027 99.5073243,159.16885 86.2761081,172.371903" id="Fill-8" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n                    <path d="M62.3051351,130.685973 C48.479027,130.685973 37.2861081,142.526814 37.2861081,147.321504 C37.2861081,148.542478 38.0031486,149.697478 39.2871081,150.735398 C40.5552162,148.202389 42.1384865,145.792035 44.2373919,143.673451 C46.5367703,141.38854 49.1615676,139.630487 51.9476757,138.347257 C46.3754595,144.014469 46.3978378,153.095575 52.0334595,158.720973 C57.7026486,164.37146 66.9085541,164.37146 72.5768108,158.720973 C78.2599865,153.061195 78.2599865,143.897389 72.5768108,138.246903 C72.0938108,137.765575 71.553,137.383673 71.0233784,136.984115 C75.134473,138.214381 79.0087297,140.440752 82.254527,143.673451 C83.9897838,145.410133 85.3362162,147.370752 86.5138784,149.405708 C86.981027,148.741327 87.3111081,148.044425 87.3111081,147.321504 C87.3111081,142.526814 76.1107297,130.685973 62.3051351,130.685973 L62.3051351,130.685973 Z M71.2163919,144.661195 C71.2163919,146.779779 69.4913919,148.491372 67.3645135,148.491372 C65.2478919,148.491372 63.5089054,146.779779 63.5089054,144.661195 C63.5089054,142.542611 65.2478919,140.822655 67.3645135,140.822655 C69.4913919,140.822655 71.2163919,142.542611 71.2163919,144.661195 L71.2163919,144.661195 Z" id="Fill-9" fill="#369ECD" sketch:type="MSShapeGroup"></path>\n                  </g>\n                </g>\n              </g>\n            </svg>\n          </div>\n          <h4>{{ \'XRay-Goggles\' | i18n }}</h4>\n          <p>{{ \'AboutGoggles\' | i18n }}</p>\n          <div class="clearfix">\n            <a class="create-user btn btn-primary" type="button" href="https://goggles.webmaker.org" autofocus>{{\'TryGoggles\' | i18n }}</a>\n            <a href="https://webmaker.org/explore" class="explore-link">{{ \'ExploreWebmaker\' | i18n }}</a>\n          </div>\n        </div>\n\n        <!-- simplified CTA -->\n        <div class="tool-desc" ng-show="simpleCTA">\n          <div class="clearfix">\n            <button class="create-user btn btn-primary" type="button" href="#" ng-click="close()">{{ \'Lets Go!\' | i18n }}</button>\n            <a href="https://webmaker.org/explore" class="explore-link">{{ \'ExploreWebmaker\' | i18n }}</a>\n          </div>\n        </div>\n    </div>\n  </form>\n</div>\n',h),login:u.renderString('<div class="modal-header">\n  <button ng-click="close()" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n  <h3 class="modal-title" ng-show="currentState === MODALSTATE.enterUid || currentState === MODALSTATE.enterPassword">\n    <button href="#" ng-click="close()" class="modal-title-left btn-link">{{ \'Cancel\' | i18n }}</button>\n    <span class="modal-title-center">{{ \'Sign in to Webmaker\' | i18n }}</span>\n    <button ng-show="currentState === MODALSTATE.enterUid"\n      ng-disabled="sendingRequest"\n      ng-click="submitUid()"\n      class="modal-title-right btn-link">{{ \'Next\' | i18n }}</button>\n    <button ng-show="currentState === MODALSTATE.enterPassword"\n      class="modal-title-right btn-link"\n      ng-disabled="sendingRequest"\n      ng-click="user.password && submitPassword()" tabindex="9">{{ \'Submit\' | i18n }}</button>\n  </h3>\n  <h3 class="modal-title" ng-show="currentState === MODALSTATE.checkEmail || currentState === MODALSTATE.resetRequestSent || currentState === MODALSTATE.enterKey">\n    <a href="#" ng-click="close()" class="modal-title-left">{{ \'Cancel\' | i18n }}</a>\n    <span class="modal-title-center">{{ \'checkEmail\' | i18n }}</span>\n    <button\n      ng-show="currentState === MODALSTATE.enterKey"\n      ng-disabled="sendingRequest"\n      ng-click="user.key && submitKey()"\n      tabindex="7"\n      class="submit-userid modal-title-right btn-link">{{ \'Next\' | i18n }}</button>\n    <a\n      class="modal-title-right"\n      ng-show="currentState === MODALSTATE.checkEmail"\n      ng-click="enterKey()"\n      tabindex="4">{{ \'Next\' | i18n }}</a>\n    <a href="#"\n      ng-show="currentState === MODALSTATE.resetRequestSent"\n      ng-click="close()" class="modal-title-right">{{ \'Done\' | i18n }}</a>\n  </h3>\n</div>\n<div class="modal-body">\n  <form class="form" name="form.user" novalidate>\n    <div class="alert alert-success" ng-show="passwordWasReset && currentState === MODALSTATE.enterUid" ng-bind-html="\'Password Reset Success\' | i18n"></div>\n    <div class="alert alert-danger" ng-show="expiredLoginLink && currentState === MODALSTATE.enterUid" ng-bind-html="\'Expired Login Link\' | i18n"></div>\n    <div class="alert alert-danger" ng-show="form.user.$error.resetRequestFailed" ng-bind-html="\'resetRequestFailed\' | i18n"></div>\n\n    <!-- Enter uid -->\n    <div ng-show="currentState === MODALSTATE.enterUid;">\n      <div class="form-group">\n        <label for="uid">{{ \'EmailOrUsername\' | i18n }}</label>\n        <input name="uid" class="form-control" ng-model="user.uid" autocomplete="on" required tabindex="1" autofocus="true" focus-on="login-uid" ng-keyup="$event.keyCode === 13 && !sendingRequest && submitUid()">\n      </div>\n      <div class="alert alert-warning" ng-show="form.user.$error.noAccount" bind-trusted-html="\'No account found for your uid\' | i18n"></div>\n      <div class="alert alert-danger" ng-show="form.user.$error.invalidUid" ng-bind-html="\'That does not look like an email address or username\' | i18n"></div>\n      <div class="cta-links clearfix">\n        <button class="submit-userid btn btn-primary hidden-xs-login" type="button" ng-disabled="sendingRequest" ng-click="submitUid()" tabindex="2">{{ \'Sign in\' | i18n }}</button>\n        <div ng-hide="disablePersona">\n          <p class="align-left">{{ \'or\' | i18n }}</p>\n          <button type="button" wm-persona-login class="btn btn-link" ng-disabled="sendingRequest" ng-click="usePersona();" tabindex="3">{{ \'log in with Persona\' | i18n }}</button>\n        </div>\n      </div>\n    </div>\n    <!-- end enter uid -->\n\n    <!-- checkEmail begins -->\n    <div class="checkEmail" ng-show="currentState === MODALSTATE.checkEmail">\n      <div class="mailIcon clearfix">\n        <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n        <svg width="94px" height="94px" viewBox="0 0 94 94" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n            <title>Mail Icon</title>\n            <desc></desc>\n            <defs></defs>\n            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n              <g id="AC4" sketch:type="MSArtboardGroup" transform="translate(-126.000000, -92.000000)">\n                <g id="Mail-Icon" sketch:type="MSLayerGroup" transform="translate(126.000000, 92.000000)">\n                    <circle id="Oval-1" fill="#3FB58E" sketch:type="MSShapeGroup" cx="47" cy="47" r="47"></circle>\n                    <rect id="Rectangle-1" fill="#FFFFFF" sketch:type="MSShapeGroup" x="18" y="27" width="59" height="41" rx="3"></rect>\n                    <path d="M21.0069321,27 C19.3462494,27 17.9900756,28.3368135 17.9778938,29.9953973 C17.9778938,29.9953973 17.9712616,30.8538058 17.9707031,31.0256348 C17.9688241,31.6037734 44.3277476,50.7739169 44.3277476,50.7739169 C45.6547338,51.7409595 47.981989,52.0459954 49.4771883,51.3411914 C49.4771883,51.3411914 52.3180561,50.8603167 59.4023438,44.0800781 C61.1871084,42.3719134 77.0395508,31.2178814 77.0395508,30.1010742 C77.0395508,29.644898 77.0391066,29.9910722 77.0391066,29.9910722 C77.0175086,28.3391486 75.6568485,27 73.9930679,27 L21.0069321,27 Z" id="Rectangle-95" fill="#F3F3F3" sketch:type="MSShapeGroup"></path>\n                    <path d="M17.7634277,31.0032813 L46.7917565,50.276875 L75.0556641,31.3201563 L46.5782176,55.1035938 L17.7634277,31.0032813 Z" id="Path-1" fill="#D8D8D8" sketch:type="MSShapeGroup"></path>\n                </g>\n              </g>\n            </g>\n        </svg>\n        <p>{{ \'tokenMessage\' | i18n }}</p>\n      </div>\n      <div class="enter-key hidden-xs-login">\n        <a ng-click="enterKey()" tabindex="4" ng-bind-html="\'Enter key\' | i18n"></a>\n      </div>\n      <hr>\n      <footer class="help-footer">\n        <p ng-bind-html="\'trouble with email\' | i18n"></p>\n      </footer>\n    </div>\n    <!-- checkEmail ends -->\n\n    <!-- enterToken begins -->\n    <div class="enterToken" ng-show="currentState === MODALSTATE.enterKey">\n      <div class="email-container">\n        <div class="mailIcon text-center">\n          <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n          <svg width="94px" height="94px" viewBox="0 0 94 94" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n              <title>Mail Icon</title>\n              <desc></desc>\n              <defs></defs>\n              <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n                  <g id="AC4" sketch:type="MSArtboardGroup" transform="translate(-126.000000, -92.000000)">\n                      <g id="Mail-Icon" sketch:type="MSLayerGroup" transform="translate(126.000000, 92.000000)">\n                          <circle id="Oval-1" fill="#3FB58E" sketch:type="MSShapeGroup" cx="47" cy="47" r="47"></circle>\n                          <rect id="Rectangle-1" fill="#FFFFFF" sketch:type="MSShapeGroup" x="18" y="27" width="59" height="41" rx="3"></rect>\n                          <path d="M21.0069321,27 C19.3462494,27 17.9900756,28.3368135 17.9778938,29.9953973 C17.9778938,29.9953973 17.9712616,30.8538058 17.9707031,31.0256348 C17.9688241,31.6037734 44.3277476,50.7739169 44.3277476,50.7739169 C45.6547338,51.7409595 47.981989,52.0459954 49.4771883,51.3411914 C49.4771883,51.3411914 52.3180561,50.8603167 59.4023438,44.0800781 C61.1871084,42.3719134 77.0395508,31.2178814 77.0395508,30.1010742 C77.0395508,29.644898 77.0391066,29.9910722 77.0391066,29.9910722 C77.0175086,28.3391486 75.6568485,27 73.9930679,27 L21.0069321,27 Z" id="Rectangle-95" fill="#F3F3F3" sketch:type="MSShapeGroup"></path>\n                          <path d="M17.7634277,31.0032813 L46.7917565,50.276875 L75.0556641,31.3201563 L46.5782176,55.1035938 L17.7634277,31.0032813 Z" id="Path-1" fill="#D8D8D8" sketch:type="MSShapeGroup"></path>\n                      </g>\n                  </g>\n              </g>\n          </svg>\n        </div>\n        <div class="key-group">\n          <div class="form-group">\n            <label for="key" ng-show="!verified">{{ \'Visit Email\' | i18n }}</label>\n            <label for="key" ng-show="verified">{{ \'Verified Visit Email\' | i18n }}</label>\n            <input ng-model="user.key" name="key" class="form-control" type="text" required tabindex="6" focus-on="enter-key" ng-keyup="$event.keyCode === 13 && user.key && !sendingRequest && submitKey()">\n          </div>\n          <div class="alert alert-danger" ng-show="form.user.$error.tokenSendFailed" ng-bind-html="\'problem sending token\' | i18n"></div>\n          <div class="alert alert-danger" ng-show="form.user.$error.invalidKey" ng-bind-html="\'incorrectToken\' | i18n"></div>\n          <div class="remember-me-token checkbox">\n            <input id="remember-me-token" ng-model="user.rememberMe" type="checkbox" name="rememberMe" tabindex="7">\n            <label for="remember-me-token" tabindex="7">\n              <div><span></span></div>\n              <span ng-bind-html="\'Remember me for one year\' | i18n"></span>\n            </label>\n          </div>\n          <button type="button" class="hidden-xs-login submit-userid btn btn-primary" type="button" ng-disabled="sendingRequest" ng-click="user.key && submitKey()" tabindex="8">{{ \'Submit\' | i18n }}</button>\n        </div>\n      </div>\n      <hr>\n      <footer class="help-footer">\n        <p ng-bind-html="\'trouble with email\' | i18n"></p>\n      </footer>\n    </div>\n    <!-- enterToken ends -->\n\n    <div class="enterPassword" ng-show="currentState === MODALSTATE.enterPassword">\n      <div class="password-container">\n        <div class="form-group">\n          <label for="password">{{ \'Password\' | i18n }}</label>\n          <input type="password" class="form-control" required name="password" ng-model="user.password" tabindex="9" focus-on="enter-password" ng-keyup="$event.keyCode === 13 && user.password && !sendingRequest && submitPassword()">\n        </div>\n        <div class="alert alert-danger" ng-show="form.user.$error.passwordSigninFailed" ng-bind-html="\'passLoginFailed\' | i18n"></div>\n        <div class="remember-me-password checkbox">\n          <input id="remember-me-password" ng-model="user.rememberMe" type="checkbox" name="rememberMe" tabindex="10">\n          <label for="remember-me-password" tabindex="10">\n            <div><span></span></div>\n            <span ng-bind-html="\'Remember me for one year\' | i18n"></span>\n          </label>\n        </div>\n        <div class="cta-links clearfix">\n          <button type="button" class="submit-password btn btn-primary hidden-xs-login" type="button" ng-disabled="sendingRequest" ng-click="user.password && submitPassword()" tabindex="11">{{ \'Submit\' | i18n }}</button>\n          <p><a ng-click="requestReset()">{{ \'Forgot your password?\' | i18n }}</a></p>\n        </div>\n      </div>\n      <hr>\n      <footer class="help-footer">\n        <p class="switch-back">{{ \'you can switch to webmaker login\' | i18n }}</p>\n      </footer>\n    </div>\n\n    <div class="resetRequestSent" ng-show="currentState === MODALSTATE.resetRequestSent">\n      <div class="mailIcon clearfix">\n        <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n        <svg width="94px" height="94px" viewBox="0 0 94 94" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n            <title>Mail Icon</title>\n            <desc></desc>\n            <defs></defs>\n            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n              <g id="AC4" sketch:type="MSArtboardGroup" transform="translate(-126.000000, -92.000000)">\n                <g id="Mail-Icon" sketch:type="MSLayerGroup" transform="translate(126.000000, 92.000000)">\n                    <circle id="Oval-1" fill="#3FB58E" sketch:type="MSShapeGroup" cx="47" cy="47" r="47"></circle>\n                    <rect id="Rectangle-1" fill="#FFFFFF" sketch:type="MSShapeGroup" x="18" y="27" width="59" height="41" rx="3"></rect>\n                    <path d="M21.0069321,27 C19.3462494,27 17.9900756,28.3368135 17.9778938,29.9953973 C17.9778938,29.9953973 17.9712616,30.8538058 17.9707031,31.0256348 C17.9688241,31.6037734 44.3277476,50.7739169 44.3277476,50.7739169 C45.6547338,51.7409595 47.981989,52.0459954 49.4771883,51.3411914 C49.4771883,51.3411914 52.3180561,50.8603167 59.4023438,44.0800781 C61.1871084,42.3719134 77.0395508,31.2178814 77.0395508,30.1010742 C77.0395508,29.644898 77.0391066,29.9910722 77.0391066,29.9910722 C77.0175086,28.3391486 75.6568485,27 73.9930679,27 L21.0069321,27 Z" id="Rectangle-95" fill="#F3F3F3" sketch:type="MSShapeGroup"></path>\n                    <path d="M17.7634277,31.0032813 L46.7917565,50.276875 L75.0556641,31.3201563 L46.5782176,55.1035938 L17.7634277,31.0032813 Z" id="Path-1" fill="#D8D8D8" sketch:type="MSShapeGroup"></path>\n                </g>\n              </g>\n            </g>\n        </svg>\n        <p>{{ \'resetMessage\' | i18n }}</p>\n      </div>\n      <hr>\n        <footer class="help-footer">\n          <p class="switch-back">{{ \'you can switch to webmaker login\' | i18n }}</p>\n        </footer>\n    </div>\n  </form>\n</div>\n',h),reset:u.renderString('<div class="modal-header">\n  <button ng-click="close()" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n  <h3 class="modal-title">\n    <a href="#" ng-click="close()" class="modal-title-left">{{ \'Cancel\' | i18n }}</a>\n    <span class="modal-title-center">{{ \'Reset Password\' | i18n }}</span>\n    <button ng-click="submitResetRequest()" ng-disabled="sendingRequest || !password.value || !password.confirmValue || !passwordsMatch || form.password.$error.passwordsMustMatch" class="modal-title-right btn-link" type="button" tabindex="3">{{ \'Submit\' | i18n }}</button>\n  </h3>\n</div>\n<div class="modal-body clearfix">\n  <form class="form" name="form.password" novalidate>\n\n    <div class="alert alert-danger" ng-show="form.password.$error.passwordsMustMatch" ng-bind-html="\'passwords do not match\' | i18n"></div>\n    <div class="alert alert-danger" ng-show="form.password.$error.weakPassword" ng-bind-html="\'Password too weak\' | i18n"></div>\n    <div class="alert alert-danger" ng-show="form.password.$error.serverError" ng-bind-html="\'error setting password\' | i18n"></div>\n\n    <div>\n      <div class="form-group">\n        <p class="password-label">{{ \'Minimum password requirements\' | i18n }}</p>\n        <ul class="list-unstyled password-strength">\n          <li id="eight-chars" ng-class="{valid: eightCharsState === \'valid\', invalid: eightCharsState === \'invalid\', \'default\': eightCharsState === \'default\'}">{{ \'At least 8 characters\' | i18n }}</li>\n          <li id="one-each-case" ng-class="{valid: oneEachCaseState === \'valid\', invalid: oneEachCaseState === \'invalid\', \'default\': oneEachCaseState === \'default\'}">{{ \'At least 1 upper and lower case character\' | i18n }}</li>\n          <li id="one-number" ng-class="{valid: oneNumberState === \'valid\', invalid: oneNumberState === \'invalid\', \'default\': oneNumberState === \'default\'}">{{ \'At least 1 number\' | i18n }}</li>\n        </ul>\n      </div>\n      <div class="form-group half-width">\n        <label for="value">{{ \'Set a Password\' | i18n }}</label>\n        <input ng-model="password.value" ng-change="checkPasswordStrength(); checkPasswordsMatch(false);" ng-blur="checkPasswordStrength(true); checkPasswordsMatch(true);" type="password" class="form-control" name="value" autocomplete="off" autofocus="true" tabindex="1" required>\n      </div>\n      <div class="form-group half-width">\n        <label for="confirmValue">{{ \'Confirm your password\' | i18n }}</label>\n        <input ng-model="password.confirmValue" ng-change="checkPasswordsMatch(false)" ng-blur="checkPasswordsMatch(true)"  type="password" class="form-control" name="confirmValue" autocomplete="off" tabindex="2" required>\n      </div>\n      <div class="cta-links clearfix">\n        <button ng-click="submitResetRequest()" ng-disabled="sendingRequest || !password.value || !password.confirmValue || !passwordsMatch || form.password.$error.passwordsMustMatch" class="reset-password btn btn-primary hidden-xs-login" type="button" tabindex="3">{{ \'Submit\' | i18n }}</button>\n      </div>\n    </div>\n  </form>\n</div>\n',h),wrapper:'<div class="modal-backdrop fade in"></div>\n<div class="modal fade in" style="display: block">\n  <div class="modal-dialog">\n    <div class="modal-content"></div>\n  </div>\n</div>\n'},p=function(e){var t=document.createRange();
t.selectNode(document.body);var n=t.createContextualFragment(d.wrapper);return n.querySelector(".modal-content").appendChild(t.createContextualFragment(e)),n},f=function(e){var t=e.querySelectorAll("[ng-bind-html]"),n=0;for(n=0;n<t.length;n++)t[n].innerHTML=i.compile(t[n].getAttribute("ng-bind-html"))();for(t=e.querySelectorAll("[bind-trusted-html]"),n=0;n<t.length;n++)t[n].innerHTML=i.compile(t[n].getAttribute("bind-trusted-html"))()},m=function(e,t){for(var n,r=e.querySelectorAll("[ng-hide],[ng-show],[ng-disabled],[ng-class]"),s=0;s<r.length;s++)r[s].getAttribute("ng-disabled")&&(i.compile(r[s].getAttribute("ng-disabled"))(t)?r[s].setAttribute("disabled",!0):r[s].removeAttribute("disabled")),r[s].getAttribute("ng-hide")&&(i.compile(r[s].getAttribute("ng-hide"))(t)?r[s].classList.add("hide"):r[s].classList.remove("hide")),r[s].getAttribute("ng-show")&&(i.compile(r[s].getAttribute("ng-show"))(t)?r[s].classList.remove("hide"):r[s].classList.add("hide")),r[s].getAttribute("ng-class")&&(n=i.compile(r[s].getAttribute("ng-class"))(t),Object.keys(n).forEach(function(e){n[e]?r[s].classList.add(e):r[s].classList.remove(e)}))},g=function(e){document.body.appendChild(e)},v=function(){document.body.removeChild(document.querySelector("body > div.modal-backdrop")),document.body.removeChild(document.querySelector("body > div.modal"))},y=function(e){n(e,"[ng-click='close()']",function(e,t){t.addEventListener("click",function(e){e.preventDefault(),v()},!1)})},b=function(e){var t=this.wmLogin=new l(e);this.showCTA=!!e.showCTA,this.disablePersona=!!e.disablePersona,r.call(this);var n=o.parse(window.location.href,!0).query;n.uid&&n.resetCode?this.request_password_reset(n.uid,n.resetCode):n.uid&&n.token&&(t.instantLogin(n.uid,n.token,n.validFor),t.on("signedIn",function(e){this.emit("login",e)}.bind(this)),t.on("signinFailed",function(e){console.log("Instant signin failed for uid %s",e),this.login(e,{expired:!0})}.bind(this))),t.on("verified",function(e){this.emit("verified",e)}.bind(this)),t.on("error",function(e){this.emit("error",e)}.bind(this)),t.verify()};a.inherits(b,r),b.prototype.create=function(e,t,i){var r=this.wmLogin.joinWebmaker(this.showCTA),s={MODALSTATE:{inputEmail:0,inputUsername:1,welcome:2},currentState:-1,form:{user:{$error:{}}},user:{},sendingRequest:!1,welcomeModalIdx:-1},o=p(d.create);f(o);var a=o.querySelector(".username-with-url");e&&(s.user.email=e,o.querySelector('input[name="email"]').value=e),t&&(s.user.username=t,o.querySelector('input[name="username"]').value=t,a.textContent=s.user.username),s.user.agree=i,r.on("sendingRequest",function(e){s.sendingRequest=e,m(l,s)}),r.on("displayEmailInput",function(){s.currentState=s.MODALSTATE.inputEmail,m(l,s),l.querySelector('input[focus-on="create-user-email"]').focus(),void 0!==s.user.email&&r.validateEmail(s.user.email)&&void 0!==s.user.agree&&(r.submitEmail(s.user.agree),s.user.agree&&(s.skippedEmail="true",r.validateUsername(s.user.username)))}),r.on("displayUsernameInput",function(){s.currentState=s.MODALSTATE.inputUsername,m(l,s),l.querySelector('input[focus-on="create-user-username"]').focus()}),r.on("displayWelcome",function(e,t){this.emit("login",e),t?s.welcomeModalIdx=0:s.simpleCTA=!0,s.currentState=s.MODALSTATE.welcome,m(l,s)}.bind(this)),r.on("displayAlert",function(e){s.form.user.$error[e]=!0,m(l,s)}),r.on("hideAlert",function(e){s.form.user.$error[e]=!1,m(l,s)}),o.querySelector('a[ng-click="switchToSignin();"]').addEventListener("click",function(e){e.preventDefault(),v(),setTimeout(function(){this.login(s.user.email)}.bind(this),0)}.bind(this)),o.querySelector('input[name="email"]').addEventListener("keyup",function(e){s.user.email=e.target.value,e.target.value&&r.validateEmail(s.user.email)}),o.querySelector('input[name="agree"]').addEventListener("change",function(e){s.user.agree=e.target.checked,r.agreeToTermsChanged(s.user.agree),m(l,s)}),o.querySelector('input[name="subscribeToList"]').addEventListener("change",function(e){s.user.subscribeToList=e.target.checked}),n(o,'button[ng-click="submitEmail()"]',function(e,t){t.addEventListener("click",function(){r.submitEmail(s.user.agree)})}),o.querySelector('input[name="username"]').addEventListener("input",function(e){s.user.username=e.target.value,r.validateUsername(s.user.username),a.textContent=s.user.username}),n(o,'button[ng-click="submitUser()"]',function(e,t){t.addEventListener("click",function(){r.submitUser(s.user)})}),m(o,s),g(o);var l=document.querySelector("body > div.modal");y(l),document.querySelector("body > div.modal > .modal-dialog").addEventListener("click",function(e){e.stopPropagation()}),document.querySelector("body > div.modal").addEventListener("click",function(){v()}),r.start()},b.prototype.login=function(e,t){t=t||{};var i=this.wmLogin.signIn(),r={MODALSTATE:{enterUid:0,checkEmail:1,enterKey:2,enterPassword:3,resetRequestSent:4},currentState:0,form:{user:{$error:{}}},user:{},passwordWasReset:!!t.password_was_reset,expiredLoginLink:!!t.expired,sendingRequest:!1,disablePersona:this.disablePersona},s=p(d.login);f(s),e&&(r.user.uid=e,s.querySelector('input[name="uid"]').value=e),i.on("sendingRequest",function(e){r.sendingRequest=e,m(o,r)}),i.on("displayEnterUid",function(){r.currentState=r.MODALSTATE.enterUid,m(o,r),o.querySelector('input[focus-on="login-uid"]').focus()}),i.on("displayEnterPassword",function(){r.currentState=r.MODALSTATE.enterPassword,m(o,r),o.querySelector('input[focus-on="enter-password"]').focus()}),i.on("displayEnterKey",function(e){r.verified=e,r.currentState=r.MODALSTATE.enterKey,m(o,r),o.querySelector('input[focus-on="enter-key"]').focus()}),i.on("displayCheckEmail",function(){r.currentState=r.MODALSTATE.checkEmail,m(o,r)}),i.on("displayResetSent",function(){r.currentState=r.MODALSTATE.resetRequestSent,m(o,r)}),i.on("displayAlert",function(e){r.form.user.$error[e]=!0,m(o,r)}),i.on("hideAlert",function(e){r.form.user.$error[e]=!1,m(o,r)}),i.on("signedIn",function(e){this.emit("login",e),v()}.bind(this)),s.querySelector('input[name="uid"]').addEventListener("input",function(e){r.user.uid=e.target.value,m(o,r)}),n(s,'input[name="rememberMe"]',function(e,t){t.addEventListener("change",function(e){r.user.rememberMe=e.target.checked,m(o,r)})}),n(s,'button[ng-click="submitUid()"]',function(e,t){t.addEventListener("click",function(){i.submitUid(r.user.uid,window.location.pathname)})}),n(s,'input[name="key"]',function(e,t){t.addEventListener("input",function(e){r.user.key=e.target.value,m(o,r)})}),n(s,'a[ng-click="enterKey()"]',function(e,t){t.addEventListener("click",function(e){e.preventDefault(),i.displayEnterKey()})}),n(s,'button[ng-click="user.key && submitKey()"]',function(e,t){t.addEventListener("click",function(){i.verifyKey(r.user.uid,r.user.key,r.user.rememberMe)})}),s.querySelector('input[name="password"]').addEventListener("input",function(e){r.user.password=e.target.value,m(o,r)}),n(s,'button[ng-click="user.password && submitPassword()"]',function(e,t){t.addEventListener("click",function(){i.verifyPassword(r.user.uid,r.user.password,r.user.rememberMe)})}),s.querySelector('a[ng-click="requestReset()"]').addEventListener("click",function(e){e.preventDefault(),i.requestReset(r.user.uid)}),s.querySelector('a[ng-click="switchToSignup();"]').addEventListener("click",function(e){e.preventDefault(),v(),setTimeout(function(){var e=r.user.uid,t=i.getUidType(e),n="email"===t?e:"",s="username"===t?e:"";this.create(n,s)}.bind(this),0)}.bind(this)),s.querySelector('button[ng-click="usePersona();"]').addEventListener("click",function(e){e.preventDefault(),v(),setTimeout(function(){this._persona_login()}.bind(this),0)}.bind(this)),s.querySelector('input[ng-keyup="$event.keyCode === 13 && !sendingRequest && submitUid()"]').addEventListener("keyup",function(e){13!==e.keyCode||r.sendingRequest||i.submitUid(r.user.uid,window.location.pathname)}.bind(this)),s.querySelector('input[ng-keyup="$event.keyCode === 13 && user.key && !sendingRequest && submitKey()"]').addEventListener("keyup",function(e){13===e.keyCode&&r.user.key&&!r.sendingRequest&&i.verifyKey(r.user.uid,r.user.key,r.user.rememberMe)}.bind(this)),s.querySelector('input[ng-keyup="$event.keyCode === 13 && user.password && !sendingRequest && submitPassword()"]').addEventListener("keyup",function(e){13===e.keyCode&&r.user.password&&!r.sendingRequest&&i.verifyPassword(r.user.uid,r.user.password,r.user.rememberMe)}.bind(this)),m(s,r),g(s);var o=document.querySelector("body > div.modal");y(o),document.querySelector("body > div.modal > .modal-dialog").addEventListener("click",function(e){e.stopPropagation()}),document.querySelector("body > div.modal").addEventListener("click",function(){v()}),i.start()},b.prototype._persona_login=function(){var e=this.wmLogin.personaLogin();e.on("signedIn",function(e){this.emit("login",e)}.bind(this)),e.on("newUser",function(e){this.create(e)}.bind(this)),e.authenticate()},b.prototype.request_password_reset=function(e,t){var n=this.wmLogin.resetPassword(),i={form:{password:{$error:{}}},password:{},sendingRequest:!1},r=p(d.reset);f(r),n.on("sendingRequest",function(e){i.sendingRequest=e,m(s,i)}),n.on("displayAlert",function(e){i.form.password.$error[e]=!0,m(s,i)}),n.on("hideAlert",function(e){i.form.password.$error[e]=!1,m(s,i)}),n.on("checkConfirmPassword",function(e){i.passwordsMatch=e,m(s,i)}),n.on("passwordCheckResult",function(e,t){return e?(i.eightCharsState=e.lengthValid?t?"valid":"":"invalid",i.oneEachCaseState=e.caseValid?t?"valid":"":"invalid",i.oneNumberState=e.digitValid?t?"valid":"":"invalid",i.isValidPassword=e.lengthValid&&e.caseValid&&e.digitValid,void m(s,i)):(i.eightCharsState=i.oneEachCaseState=i.oneNumberState="default",void(i.isValidPassword=!1))}),n.on("resetSucceeded",function(){v(),setTimeout(function(){this.login(e,{password_was_reset:!0})}.bind(this),0)}.bind(this)),r.querySelector('input[name="value"]').addEventListener("input",function(e){i.password.value=e.target.value,n.checkPasswordStrength(i.password.value,!1)}),r.querySelector('input[name="value"]').addEventListener("blur",function(e){i.password.value=e.target.value,n.checkPasswordStrength(i.password.value,!0)}),r.querySelector('input[name="confirmValue"]').addEventListener("input",function(e){i.password.confirmValue=e.target.value,n.passwordsMatch(i.password.value,i.password.confirmValue,!1)}),r.querySelector('input[name="confirmValue"]').addEventListener("blur",function(e){i.password.confirmValue=e.target.value,n.passwordsMatch(i.password.value,i.password.confirmValue,!0)}),r.querySelector('button[ng-click="submitResetRequest()"]').addEventListener("click",function(){n.submitResetRequest(e,t,i.password.value)}),m(r,i),g(r);var s=document.querySelector("body > div.modal");y(s),document.querySelector("body > div.modal > .modal-dialog").addEventListener("click",function(e){e.stopPropagation()}),document.querySelector("body > div.modal").addEventListener("click",function(){v()})},b.prototype.logout=function(){var e=this.wmLogin.logout();e.on("loggedOut",function(){this.emit("logout")}.bind(this)),e.logout()},window.WebmakerLogin=b,t.exports=b},{"../../locale/en_US/webmaker-login.json":37,"../core":45,"angular-expressions":38,events:20,nunjucks:42,url:27,util:29}],45:[function(e,t){var n=e("./state"),i=e("./loginAPI"),r=e("./state/emitter");t.exports=function(e){function t(){s.verify(function(e,t,n){if(e)return o.emit("error",e);try{n=JSON.parse(n)}catch(i){return o.emit("error","could not parse json from verify route")}o.emit("verified",n.user)})}var s=new i(e),o=new r;return window.addEventListener("focus",t),{on:function(e,t){o.on(e,t)},off:function(e,t){o.off(e,t)},joinWebmaker:function(e){return new n.JoinController(s,!!e)},signIn:function(){return new n.SignInController(s)},resetPassword:function(){return new n.ResetController(s)},personaLogin:function(){return new n.PersonaController(s)},logout:function(){return new n.LogoutController(s)},instantLogin:function(e,t,n){s.verifyKey(e,t,n,function(t,n,i){return t||200!==n.status||!i.user?o.emit("signinFailed",e):void o.emit("signedIn",i.user)})},verify:t}}},{"./loginAPI":46,"./state":50,"./state/emitter":49}],46:[function(e,t){var n=e("browser-request");t.exports=function(t){function i(e,t,i){n({method:"post",uri:e,timeout:y,withCredentials:v,headers:b,json:t},i)}function r(e,t){i(g.uidExists,{uid:e},t)}function s(e,t){i(g.checkUsername,{username:e},t)}function o(e,t){e.referrer=m.refValue(),i(g.createUser,{user:e,audience:w},function(){m.clearReferrerCookie(),t.apply(null,arguments)})}function a(e,t,n){i(g.request,{uid:e,path:t},n)}function l(e,t,n,r){i(g.authenticateToken,{uid:e,token:t,validFor:n,user:{referrer:m.refValue()}},function(){m.clearReferrerCookie(),r.apply(null,arguments)})}function c(e,t,n,r){i(g.verifyPassword,{uid:e,password:t,validFor:n,user:{referrer:m.refValue()}},function(){m.clearReferrerCookie(),r.apply(null,arguments)})}function u(e,t){i(g.requestResetCode,{uid:e},t)}function h(e,t,n,r){i(g.resetPassword,{uid:e,resetCode:t,newPassword:n},r)}function d(e,t){i(g.authenticate,{assertion:e,audience:w,user:{referrer:m.refValue()}},t)}function p(e){i(g.logout,null,e)}function f(e){i(g.verify,null,e)}t=t||{},t.paths=t.paths||{};var m=e("./referrals.js")(),g=e("./loginUrls.js")(t),v=t.withCredentials===!1?!1:!0,y=1e3*(t.timeout||10),b={"X-CSRF-Token":t.csrfToken},w=t.audience||window.location.protocol+"//"+window.location.host;return{uidExists:r,checkUsername:s,createUser:o,sendLoginKey:a,verifyKey:l,verifyPassword:c,requestReset:u,resetPassword:h,personaLogin:d,logout:p,verify:f}}},{"./loginUrls.js":47,"./referrals.js":48,"browser-request":40}],47:[function(e,t){t.exports=function(e){var t={},n=e.host||"";return t=e.paths||{},t.authenticate=e.paths.authenticate||"/authenticate",t.legacyCreate=e.paths.legacyCreate||"/create",t.verify=e.paths.verify||"/verify",t.logout=e.paths.logout||"/logout",t.checkUsername=e.paths.checkUsername||"/check-username",t.request=e.paths.request||"/auth/v2/request",t.uidExists=e.paths.uidExists||"/auth/v2/uid-exists",t.createUser=e.paths.createUser||"/auth/v2/create",t.authenticateToken=e.paths.authenticateToken||"/auth/v2/authenticateToken",t.verifyPassword=e.paths.verifyPassword||"/auth/v2/verify-password",t.requestResetCode=e.paths.requestResetCode||"/auth/v2/request-reset-code",t.removePassword=e.paths.removePassword||"/auth/v2/remove-password",t.enablePasswords=e.paths.enablePasswords||"/auth/v2/enable-passwords",t.resetPassword=e.paths.resetPassword||"/auth/v2/reset-password",{request:n+t.request,authenticateToken:n+t.authenticateToken,authenticate:n+t.authenticate,legacyCreate:n+t.legacyCreate,createUser:n+t.createUser,verify:n+t.verify,logout:n+t.logout,uidExists:n+t.uidExists,checkUsername:n+t.checkUsername,verifyPassword:n+t.verifyPassword,requestResetCode:n+t.requestResetCode,removePassword:n+t.removePassword,enablePasswords:n+t.enablePasswords,resetPassword:n+t.resetPassword}}},{}],48:[function(e,t){var n=e("cookie-js");t.exports=function(){var e={domain:location.hostname.split(".").slice(-2).join("."),path:"/",secure:"https:"===location.protocol,expires:new Date(Date.now()+6048e5)},t=/ref=((?:\w|-)+)/.exec(window.location.search),i=n.parse(document.cookie).webmakerReferral;return t&&(t=t[1],i!==t&&(document.cookie=n.serialize("webmakerReferral",t,e),i=t)),{clearReferrerCookie:function(){e.expires=new Date(Date.now()-1e4),document.cookie=n.serialize("webmakerReferral","expire",e),e.expires=new Date(Date.now()+6048e5)},refValue:function(){return i}}}},{"cookie-js":41}],49:[function(e,t){var n=e("events").EventEmitter;t.exports=function(){var e=new n;return{on:function(t,n){e.addListener(t,n)},off:function(t,n){return n?void e.removeListener(t,n):void e.removeAllListeners(t)},emit:function(){e.emit.apply(e,arguments)}}}},{events:20}],50:[function(e,t){t.exports={JoinController:e("./join.js"),SignInController:e("./signin.js"),ResetController:e("./reset.js"),PersonaController:e("./persona.js"),LogoutController:e("./logout.js")}},{"./join.js":51,"./logout.js":52,"./persona.js":53,"./reset.js":54,"./signin.js":55}],51:[function(e,t){var n=e("./emitter.js"),i=e("../validation"),r=e("webmaker-analytics");t.exports=function(e,t){function s(){h.emit.apply(h,arguments)}function o(e){s(p.sendingRequest,e,e?!1:!0)}function a(e,t){s(p.displayAlert,e,t)}function l(e){e=Array.isArray(e)?e:[e],e.forEach(function(e){s(p.hideAlert,e)})}function c(e,t,n){return o(!1),e||200!==t.status?a(d.serverError,!0):n.exists?a(d.accountExists,!0):void 0}function u(e,t,n){return o(!1),e||200!==t.status?a(d.serverError,!0):n.exists?a(d.usernameTaken,!0):void s(p.displayUsernameInput)}var h=new n,d={agreeToTerms:"agreeToTerms",accountExists:"accountExists",invalidEmail:"invalidEmail",invalidUsername:"invalidUsername",usernameTaken:"usernameTaken",serverError:"serverError"},p={sendingRequest:"sendingRequest",displayAlert:"displayAlert",hideAlert:"hideAlert",displayUsernameInput:"displayUsernameInput",displayEmailInput:"displayEmailInput",displayWelcome:"displayWelcome"};return{on:function(e,t){h.on(e,t)},off:function(e,t){return t?void h.removeListener(e,t):h.off(e)},start:function(){s(p.displayEmailInput)},validateEmail:function(t){l([d.invalidEmail,d.accountExists,d.serverError]);var n=i.isEmail(t);return n?(o(!0),e.uidExists(t,c),!0):(a(d.invalidEmail),!1)},submitEmail:function(e){return e?void s(p.displayUsernameInput):a(d.agreeToTerms)},agreeToTermsChanged:function(e){e&&s(p.hideAlert,d.agreeToTerms)},validateUsername:function(t){if(l([d.invalidUsername,d.usernameTaken,d.serverError]),t){var n=i.isUsername(t);if(!n)return a(d.invalidUsername);o(!0),e.uidExists(t,u)}},submitUser:function(n){l([d.agreeToTerms,d.serverError]);var i="en-US",c=document.querySelector("html");c.lang&&(i=c.lang),o(!0),e.createUser({email:n.email,username:n.username,mailingList:n.subscribeToList,prefLocale:i},function(e,n,i){return o(!1),e||200!==n.status?a(d.serverError):(r.event("Webmaker New User Created",{nonInteraction:!0}),r.conversionGoal("WebmakerNewUserCreated"),void s(p.displayWelcome,i.user,t))})}}}},{"../validation":56,"./emitter.js":49,"webmaker-analytics":43}],52:[function(e,t){var n=e("./emitter.js"),i=e("webmaker-analytics");t.exports=function(e){function t(){r.emit.apply(r,arguments)}var r=new n;return{on:function(e,t){r.on(e,t)},off:function(e,t){r.off(e,t)},logout:function(){e.logout(function(e,n){return e||200!==n.status?t("logoutFailed"):(i.event("Webmaker Logout Clicked"),void t("loggedOut"))})}}}},{"./emitter.js":49,"webmaker-analytics":43}],53:[function(e,t){var n=e("./emitter.js"),i=e("webmaker-analytics");t.exports=function(e){function t(){r.emit.apply(r,arguments)}var r=new n,s={signedIn:"signedIn",newUser:"newUser"},o={label:"persona"};return{on:function(e,t){r.on(e,t)},off:function(e,t){r.off(e,t)},authenticate:function(){return window.navigator.id?(i.event("Persona Login Clicked"),void window.navigator.id.get(function(n){return n?void e.personaLogin(n,function(e,n,r){return e||200!==n.status?void i.event("Webmaker Login Failed",o):(i.event("Webmaker Login Succeeded",o),void(r.user?t(s.signedIn,r.user):r.email&&(i.event("Webmaker New User Started",o),t(s.newUser,r.email))))}):void i.event("Webmaker Login Cancelled",o)})):console.error("No persona found. Did you load include.js?")}}}},{"./emitter.js":49,"webmaker-analytics":43}],54:[function(e,t){var n=e("./emitter.js"),i=e("../validation"),r=e("webmaker-analytics");t.exports=function(e){function t(){l.emit.apply(l,arguments)}function s(e){t(u.sendingRequest,e)}function o(e){t(u.displayAlert,e)}function a(e){t(u.hideAlert,e)}var l=new n,c={passwordsMustMatch:"passwordsMustMatch",weakPassword:"weakPassword",serverError:"serverError"},u={sendingRequest:"sendingRequest",displayAlert:"displayAlert",hideAlert:"hideAlert",resetSucceeded:"resetSucceeded",passwordCheckResult:"passwordCheckResult",checkConfirmPassword:"checkConfirmPassword"};return{on:function(e,t){l.on(e,t)},off:function(e,t){l.off(e,t)},passwordsMatch:function(e,n,r){i.passwordsMatch(e,n)?(a(c.passwordsMustMatch),t(u.checkConfirmPassword,!0)):(r&&o(c.passwordsMustMatch),t(u.checkConfirmPassword,!1))},checkPasswordStrength:function(e,n){t(u.passwordCheckResult,i.checkPasswordStrength(e),n)},submitResetRequest:function(n,i,l){a(c.serverError),a(c.weakPassword),s(!0),e.resetPassword(n,i,l,function(e,n){return s(!1),e||200!==n.status?o(400===n.status?c.weakPassword:c.serverError):(r.event("Webmaker Password Reset Succeeded"),void t(u.resetSucceeded))})}}}},{"../validation":56,"./emitter.js":49,"webmaker-analytics":43}],55:[function(e,t){var n=e("./emitter.js"),i=e("../validation"),r=e("webmaker-analytics");t.exports=function(e){function t(){c.emit.apply(c,arguments)}function s(e){t(h.sendingRequest,e)}function o(e){t(h.displayAlert,e)}function a(e){t(h.hideAlert,e)}function l(e){e=Array.isArray(e)?e:[e],e.forEach(function(e){a(e)})}var c=new n,u={paswordReset:"paswordReset",noAccount:"noAccount",invalidUid:"invalidUid",serverError:"serverError",invalidKey:"invalidKey",passwordSigninFailed:"passwordSigninFailed",resetRequestFailed:"resetRequestFailed"},h={sendingRequest:"sendingRequest",displayAlert:"displayAlert",hideAlert:"hideAlert",displayEnterUid:"displayEnterUid",displayEnterPassword:"displayEnterPassword",displayEnterKey:"displayEnterKey",displayCheckEmail:"displayCheckEmail",displayResetSent:"displayResetSent",signedIn:"signedIn"};return{on:function(e,t){c.on(e,t)},off:function(e,t){c.off(e,t)},start:function(){t(h.displayEnterUid)},submitUid:function(n,r){l([u.invalidUid,u.serverError,u.noAccount]);var a=i.isEmail(n)||i.isUsername(n);return a?(s(!0),void e.uidExists(n,function(i,a,l){if(s(!1),i||200!==a.status)return o(u.serverError);var c=l.verified;return l.exists?l.usePasswordLogin?t(h.displayEnterPassword):void e.sendLoginKey(n,r,function(e){return e?o(u.serverError):void(c?t(h.displayEnterKey,!1):t(h.displayCheckEmail))}):o(u.noAccount)})):o(u.invalidUid)},displayEnterKey:function(){t(h.displayEnterKey,!0)},verifyKey:function(n,i,a){l([u.serverError,u.invalidKey]),s(!0);var c=a?"one-year":"";e.verifyKey(n,i,c,function(e,n,i){return s(!1),e?o(u.serverError):i.user?(r.event("Webmaker Login Succeeded",{label:"key"}),void t(h.signedIn,i.user)):o(u.invalidKey)})},verifyPassword:function(n,i,a){s(!0);var l=a?"one-year":"";e.verifyPassword(n,i,l,function(e,n,i){return s(!1),e?o(u.serverError):i.user?(r.event("Webmaker Login Succeeded",{label:"password"}),void t(h.signedIn,i.user)):o(u.passwordSigninFailed)})},requestReset:function(n){s(!0),e.requestReset(n,function(e,n,i){return s(!1),e?o(u.serverError):i.status?(r.event("Webmaker Password Reset Requested"),void t(h.displayResetSent)):o(u.resetRequestFailed)})},getUidType:function(e){return i.isEmail(e)?"email":i.isUsername(e)?"username":null}}}},{"../validation":56,"./emitter.js":49,"webmaker-analytics":43}],56:[function(e,t){var n=/^[a-zA-Z0-9\-]{1,20}$/,i=/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/,r=/^.*(?=.*[a-z])(?=.*[A-Z]).*$/,s=/\d/,o=8;t.exports={isEmail:function(e){return i.test(e)},isUsername:function(e){return n.test(e)},passwordsMatch:function(e,t){return e===t},checkPasswordStrength:function(e){if(!e)return!1;var t=e.length>=o,n=!!e.match(r),i=!!e.match(s);return{lengthValid:t,caseValid:n,digitValid:i}}}},{}]},{},[4]);